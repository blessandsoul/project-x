import{a as B,b as M,x as W,r as l,ar as f,j as e,m as j,B as m,I as n,J as b,S as u}from"./index-zfRgVEOB.js";import{C as h,a as x}from"./card-DHN41EoD.js";import{B as Y}from"./badge-CitRu_Pl.js";import{A as S,h as A,a as C,b as D,c as R,d as E,e as F,f as O,g as z}from"./alert-dialog-D3X7DhcZ.js";function $(s){if(!s)return{browser:"Unknown",os:"Unknown",icon:"mdi:monitor"};let t="Unknown",r="Unknown",a="mdi:monitor";return s.includes("Chrome")&&!s.includes("Edg")?(t="Chrome",a="mdi:google-chrome"):s.includes("Firefox")?(t="Firefox",a="mdi:firefox"):s.includes("Safari")&&!s.includes("Chrome")?(t="Safari",a="mdi:apple-safari"):s.includes("Edg")?(t="Edge",a="mdi:microsoft-edge"):(s.includes("Opera")||s.includes("OPR"))&&(t="Opera",a="mdi:opera"),s.includes("Windows")?r="Windows":s.includes("Mac OS")?r="macOS":s.includes("Linux")?r="Linux":s.includes("Android")?r="Android":(s.includes("iPhone")||s.includes("iPad"))&&(r="iOS"),{browser:t,os:r,icon:a}}function H(s){return new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}const Q=()=>{const{t:s}=B(),t=M(),{logout:r}=W(),[a,v]=l.useState([]),[I,L]=l.useState(!0),[p,o]=l.useState(null),[P,N]=l.useState(null),[w,y]=l.useState(!1),k=l.useCallback(async()=>{try{o(null);const i=await f.get("/auth/sessions");v(i.data.sessions)}catch{o(s("sessions.error.fetch","Failed to load sessions"))}finally{L(!1)}},[s]);l.useEffect(()=>{k()},[k]);const T=async(i,c)=>{N(i);try{await f.delete(`/auth/sessions/${i}`),c?(await r(),t("/login",{replace:!0})):v(d=>d.filter(g=>g.id!==i))}catch{o(s("sessions.error.revoke","Failed to revoke session"))}finally{N(null)}},U=async()=>{y(!0);try{await f.delete("/auth/sessions"),await r(),t("/login",{replace:!0})}catch{o(s("sessions.error.revoke_all","Failed to revoke all sessions"))}finally{y(!1)}};return e.jsx("div",{className:"container max-w-3xl mx-auto px-4 py-8",children:e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"h-9 w-9",children:e.jsx(n,{icon:"mdi:arrow-left",className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:s("sessions.title","Active Sessions")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("sessions.subtitle","Manage your active login sessions")})]})]}),a.length>1&&e.jsxs(S,{children:[e.jsx(A,{asChild:!0,children:e.jsxs(m,{variant:"destructive",size:"sm",disabled:w,children:[w?e.jsx(n,{icon:"mdi:loading",className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(n,{icon:"mdi:logout-variant",className:"mr-2 h-4 w-4"}),s("sessions.revoke_all","Sign out everywhere")]})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(R,{children:s("sessions.revoke_all_title","Sign out of all sessions?")}),e.jsx(E,{children:s("sessions.revoke_all_description","This will sign you out of all devices, including this one. You will need to sign in again.")})]}),e.jsxs(F,{children:[e.jsx(O,{children:s("common.cancel","Cancel")}),e.jsx(z,{onClick:U,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("sessions.confirm_revoke_all","Sign out everywhere")})]})]})]})]}),e.jsx(b,{children:p&&e.jsx(j.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-4",children:e.jsxs("div",{className:"p-3 rounded-md bg-destructive/10 text-destructive text-sm flex items-center gap-2",children:[e.jsx(n,{icon:"mdi:alert-circle",className:"h-4 w-4 shrink-0"}),p,e.jsx(m,{variant:"ghost",size:"sm",className:"ml-auto h-6 px-2",onClick:()=>o(null),children:e.jsx(n,{icon:"mdi:close",className:"h-4 w-4"})})]})})}),e.jsx("div",{className:"space-y-3",children:I?Array.from({length:3}).map((i,c)=>e.jsx(h,{children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(u,{className:"h-4 w-32"}),e.jsx(u,{className:"h-3 w-48"})]}),e.jsx(u,{className:"h-8 w-20"})]})})},c)):a.length===0?e.jsx(h,{children:e.jsxs(x,{className:"p-8 text-center",children:[e.jsx(n,{icon:"mdi:devices",className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:s("sessions.no_sessions","No active sessions found")})]})}):e.jsx(b,{children:a.map(i=>{const{browser:c,os:d,icon:g}=$(i.user_agent),_=P===i.id;return e.jsx(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-20},layout:!0,children:e.jsx(h,{className:i.is_current?"border-primary/50 bg-primary/5":"",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${i.is_current?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(n,{icon:g,className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium truncate",children:[c," on ",d]}),i.is_current&&e.jsx(Y,{variant:"default",className:"text-xs",children:s("sessions.current","Current")})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-0.5",children:[i.ip&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{icon:"mdi:ip-network",className:"h-3 w-3"}),e.jsx("span",{children:i.ip})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{icon:"mdi:clock-outline",className:"h-3 w-3"}),e.jsxs("span",{children:[s("sessions.signed_in","Signed in")," ",H(i.created_at)]})]})]})]}),e.jsxs(S,{children:[e.jsx(A,{asChild:!0,children:e.jsxs(m,{variant:i.is_current?"destructive":"outline",size:"sm",disabled:_,children:[_?e.jsx(n,{icon:"mdi:loading",className:"h-4 w-4 animate-spin"}):e.jsx(n,{icon:"mdi:logout",className:"h-4 w-4"}),e.jsx("span",{className:"ml-1.5 hidden sm:inline",children:i.is_current?s("sessions.sign_out","Sign out"):s("sessions.revoke","Revoke")})]})}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(R,{children:i.is_current?s("sessions.sign_out_title","Sign out of this session?"):s("sessions.revoke_title","Revoke this session?")}),e.jsx(E,{children:i.is_current?s("sessions.sign_out_description","You will be signed out and redirected to the login page."):s("sessions.revoke_description","This device will be signed out immediately.")})]}),e.jsxs(F,{children:[e.jsx(O,{children:s("common.cancel","Cancel")}),e.jsx(z,{onClick:()=>T(i.id,i.is_current),className:i.is_current?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"",children:i.is_current?s("sessions.confirm_sign_out","Sign out"):s("sessions.confirm_revoke","Revoke")})]})]})]})]})})})},i.id)})})}),e.jsx(h,{className:"mt-6 bg-muted/50",children:e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(n,{icon:"mdi:information-outline",className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium text-foreground mb-1",children:s("sessions.info_title","About sessions")}),e.jsx("p",{children:s("sessions.info_description","Sessions are created when you sign in. If you see a session you don't recognize, revoke it immediately and change your password.")})]})]})})})]})})};export{Q as default};
