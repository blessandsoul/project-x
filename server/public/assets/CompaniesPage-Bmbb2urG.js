import{r as t,a as k,j as e,I as p,W as D,B as C,c as b,b as O,ax as $,S as g}from"./index-CYKg8lnZ.js";import{E}from"./EmptyState-C3UasEbm.js";import{C as B}from"./checkbox-VT0TGVbc.js";import{L as H}from"./label-Ctu8vCLr.js";import{I as Q}from"./image-D0Gm8aGY.js";import{s as W}from"./companiesApi-DaklqqwI.js";const q=[10,20,30,50,100],F=t.memo(({searchInput:s,onSearchInputChange:i,onSearchSubmit:o,isVip:c,onVipToggle:u,limit:r,onLimitChange:m,totalCompanies:f,displayedCount:d})=>{const{t:x}=k();return e.jsx("div",{className:"bg-white p-4 border border-slate-200 rounded-lg mb-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("form",{onSubmit:o,className:"flex gap-2 max-w-sm flex-1",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(p,{icon:"mdi:magnify",className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(D,{type:"text",placeholder:x("companies.search.placeholder","Search companies..."),value:s,onChange:n=>i(n.target.value),className:"pl-9 h-9 text-sm border-slate-300"})]}),e.jsxs(C,{type:"submit",size:"sm",className:"h-9 shadow-sm",children:[e.jsx(p,{icon:"mdi:magnify",className:"h-4 w-4 mr-1.5"}),x("common.search","Search")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 border-l border-slate-200 pl-4",children:[e.jsx(B,{id:"vip-filter",checked:c,onCheckedChange:u}),e.jsxs(H,{htmlFor:"vip-filter",className:"text-sm font-medium cursor-pointer flex items-center gap-1.5",children:[e.jsx(p,{icon:"mdi:star",className:"h-4 w-4 text-amber-500"}),x("companies.filter.vip","VIP Only")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-600 font-medium",children:[x("companies.filter.show","Show"),":"]}),e.jsx("div",{className:"flex gap-1",children:q.map(n=>e.jsx("button",{type:"button",onClick:()=>m(n),className:b("px-2.5 py-1 text-xs font-medium rounded-md border transition-colors",r===n?"bg-primary text-white border-primary shadow-sm":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 hover:border-slate-400"),children:n},n))})]}),f>0&&e.jsxs("p",{className:"text-xs font-medium text-slate-600 ml-auto",children:[x("catalog.results.showing")," ",e.jsx("span",{className:"font-bold text-slate-900",children:d})," ",x("catalog.results.connector")," ",e.jsx("span",{className:"font-bold text-slate-900",children:f})," ",x("catalog.results.of")]})]})})});F.displayName="SearchFilterHeader";const M=t.memo(({company:s,className:i})=>{const o=O(),{t:c}=k(),u=t.useMemo(()=>s.rating>4.5,[s.rating]),r=()=>{o(`/company/${s.id}`)},f=(d=>d?d.charAt(0).toUpperCase()+d.slice(1).toLowerCase():"")(s.location?.city)||c("catalog.card.default_city","Tbilisi");return e.jsxs("div",{className:b("relative grid grid-cols-[minmax(0,1fr)_auto] gap-1.5 md:gap-4 items-center rounded-lg border border-slate-200 bg-white shadow-sm px-2 py-2.5 md:px-5 md:py-3 cursor-pointer","transition-all duration-200 hover:bg-slate-50/50 hover:shadow-md hover:border-slate-300",i),onClick:()=>o(`/company/${s.id}`),children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 min-w-0",children:[e.jsxs("div",{className:"relative flex-shrink-0 h-11 w-11 md:h-[54px] md:w-[54px]",children:[e.jsx("button",{type:"button",className:"h-full w-full rounded-lg overflow-hidden bg-slate-50 focus:outline-none focus:ring-2 focus:ring-primary/50 cursor-pointer transition-all hover:shadow-sm",onClick:d=>{d.stopPropagation(),r()},children:e.jsx(Q,{src:s.logo||"/car-logos/toyota.png",alt:`${s.name} logo`,className:"h-full w-full",fallbackSrc:"/car-logos/toyota.png",objectFit:"contain"})}),e.jsx("span",{className:b("absolute -bottom-0.5 -right-0.5 h-2.5 w-2.5 md:h-3 md:w-3 rounded-full ring-2 ring-white pointer-events-none",u?"bg-green-500":"bg-slate-400")})]}),e.jsxs("div",{className:"flex flex-col justify-between min-w-0 flex-1 h-11 md:h-[54px] py-0.5",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),r()},className:"text-left py-0.5",children:e.jsx("h3",{className:"text-xs md:text-sm font-semibold text-slate-900 hover:text-primary leading-tight transition-colors capitalize",children:s.name})}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] md:text-xs text-slate-500 leading-none pb-0.5",children:[e.jsx(p,{icon:"mdi:map-marker",className:"h-2.5 w-2.5 md:h-3 md:w-3 flex-shrink-0"}),e.jsx("span",{className:"truncate capitalize",children:f}),s.vipStatus&&e.jsxs("span",{className:"inline-flex items-center gap-0.5 ml-1 text-[8px] font-semibold text-amber-700 bg-amber-50 px-1 py-0.5 rounded",children:[e.jsx(p,{icon:"mdi:crown",className:"w-2 h-2"}),c("catalog.card.vip","VIP")]})]})]})]}),e.jsx("div",{className:"flex items-center justify-center border-l border-slate-100 pl-2 md:pl-4 h-full",children:e.jsxs("div",{className:"flex items-center gap-1 md:gap-1.5 whitespace-nowrap",children:[e.jsx(p,{icon:"mdi:star",className:"h-3 w-3 md:h-4 md:w-4 text-amber-400 fill-current"}),e.jsx("span",{className:"font-semibold text-xs md:text-sm text-slate-700",children:s.rating}),e.jsxs("span",{className:"hidden md:inline text-xs text-slate-400",children:["(",s.reviewCount,")"]})]})})]})});M.displayName="CompanyRowItem";const z=t.memo(({companies:s})=>e.jsx("div",{className:"grid gap-3 xl:gap-4 grid-cols-1 md:grid-cols-2 min-[1400px]:grid-cols-3",children:s.map(i=>e.jsx(M,{company:i},i.id))}));z.displayName="CompanyList";const G=20,se=()=>{const{t:s}=k(),[i,o]=$(),c=i.get("search")||"",u=i.get("vip")==="true",r=Number(i.get("limit"))||G,[m,f]=t.useState([]),[d,x]=t.useState(0),[n,I]=t.useState(!0),[j,P]=t.useState(null),[h,N]=t.useState(1),[v,L]=t.useState(c),y=t.useCallback(async()=>{I(!0),P(null);try{const{companies:a,total:l}=await W({limit:r,search:c||void 0,isVip:u||void 0});f(a),x(l)}catch{P(s("companies.error.load","Failed to load companies. Please try again."))}finally{I(!1)}},[s,r,c,u]);t.useEffect(()=>{y()},[y]),t.useEffect(()=>{L(c)},[c]);const T=t.useMemo(()=>{const a=(h-1)*r;return m.slice(a,a+r)},[m,h,r]),w=t.useMemo(()=>Math.ceil(m.length/r),[m.length,r]),A=t.useCallback(()=>{y()},[y]),R=t.useCallback(a=>{a.preventDefault();const l=new URLSearchParams(i);v.trim()?l.set("search",v.trim()):l.delete("search"),o(l),N(1)},[v,i,o]),V=t.useCallback(a=>{L(a)},[]),_=t.useCallback(a=>{const l=new URLSearchParams(i);a?l.set("vip","true"):l.delete("vip"),o(l),N(1)},[i,o]),U=t.useCallback(a=>{const l=new URLSearchParams(i);l.set("limit",String(a)),o(l),N(1)},[i,o]),S=t.useCallback(a=>{N(a),window.scrollTo({top:0,behavior:"smooth"})},[]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"bg-white border-b border-slate-200",children:e.jsx("div",{className:"w-full max-w-[1400px] mx-auto px-4 py-4",children:e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:s("navigation.companies")})})}),e.jsxs("main",{className:"w-full max-w-[1400px] mx-auto px-4 py-6",children:[!n&&!j&&e.jsx(F,{searchInput:v,onSearchInputChange:V,onSearchSubmit:R,isVip:u,onVipToggle:_,limit:r,onLimitChange:U,totalCompanies:m.length,displayedCount:T.length}),n&&e.jsx("div",{className:"grid gap-3 xl:gap-4 grid-cols-1 md:grid-cols-2 min-[1400px]:grid-cols-3",children:Array.from({length:6}).map((a,l)=>e.jsxs("div",{className:"rounded-md border border-slate-200 bg-white shadow-sm px-4 py-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"h-12 w-12 xl:h-14 xl:w-14 rounded-2xl shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(g,{className:"h-4 w-28"}),e.jsx(g,{className:"h-3 w-16"})]})]}),e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(g,{className:"h-3 w-20"}),e.jsx(g,{className:"h-3 w-16"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-3 w-12"}),e.jsxs("div",{className:"ml-auto flex gap-1.5",children:[e.jsx(g,{className:"h-7 w-16"}),e.jsx(g,{className:"h-7 w-16"})]})]})]},l))}),j&&!n&&e.jsx("div",{className:"py-16",children:e.jsx(E,{icon:"mdi:alert-circle-outline",title:s("companies.error.title","Something went wrong"),description:j,action:e.jsxs(C,{onClick:A,variant:"outline",children:[e.jsx(p,{icon:"mdi:refresh",className:"mr-2 h-4 w-4"}),s("common.retry","Try Again")]})})}),!n&&!j&&m.length===0&&e.jsx("div",{className:"py-16",children:e.jsx(E,{icon:"mdi:office-building-outline",title:s("companies.empty.title","No companies found"),description:s("companies.empty.description","There are no companies available at the moment.")})}),!n&&!j&&m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(z,{companies:T}),w>1&&e.jsxs("div",{className:"flex justify-center items-center gap-1 mt-6",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>S(Math.max(1,h-1)),disabled:h<=1,className:b("h-7 w-7 p-0 flex items-center justify-center text-[11px] transition-all",h<=1?"border-slate-200 text-slate-400 bg-transparent cursor-not-allowed":"border-slate-300 text-slate-600 bg-white hover:bg-slate-50"),children:e.jsx(p,{icon:"mdi:chevron-left",className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:w},(a,l)=>l+1).map(a=>{const l=a===h;return e.jsx("button",{type:"button",onClick:()=>!l&&S(a),"aria-current":l?"page":void 0,className:b("h-7 min-w-[28px] px-2 text-[11px] font-medium transition-all border flex items-center justify-center",l?"bg-primary border-primary text-white":"bg-white border-slate-200 text-slate-700 hover:bg-slate-50"),children:a},a)})}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>S(Math.min(w,h+1)),disabled:h>=w,className:b("h-7 w-7 p-0 flex items-center justify-center text-[11px] transition-all",h>=w?"border-slate-200 text-slate-400 bg-transparent cursor-not-allowed":"border-slate-300 text-slate-600 bg-white hover:bg-slate-50"),children:e.jsx(p,{icon:"mdi:chevron-right",className:"h-4 w-4"})})]})]})]})]})};export{se as default};
