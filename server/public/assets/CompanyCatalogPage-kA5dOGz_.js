import{a as he,r as c,j as e,I as f,c as Y,d as Ie,e as Ae,B as D,f as De,g as Le,h as Me,i as Ue,k as $e,A as ze,m as be,S as q,l as ae,n as le,o as re,p as ce,q as W,s as ve,t as qe,v as Oe}from"./index-CSgTRbNC.js";import{E as Ge}from"./EmptyState-Cqrnqq96.js";import{C as ye}from"./checkbox-yKpFDs6Y.js";import{F as He,a as A,b as ee,c as je,d as Ne}from"./FiltersSidebarLayout-B0Z52trJ.js";import{C as Ke}from"./CompanyListItem-BOQ6dDHv.js";import{B as we}from"./badge-zj69FNPh.js";import{L as ne}from"./label-DarQQ0iR.js";import{s as We}from"./companiesApi-CzKtJjX4.js";import"./image-C2nimm8t.js";const Ce=({className:h,initialSearch:x,onSearchSubmit:b,onSearchChange:y,initialCountry:M,onCountryChange:I,initialCity:d,onCityChange:O,initialMinRating:P,onMinRatingChange:U,initialPriceRange:l,onPriceRangeChange:m,initialIsVip:C,onVipChange:k,onApplyFilters:V,onResetFilters:N})=>{const{t:o}=he();c.useRef(null),c.useRef(null),c.useRef(null);const[g,T]=c.useState(l??[0,5e3]);c.useEffect(()=>{l&&T(l)},[l]);const[S,$]=c.useState(x??""),[_,F]=c.useState(M??""),[J,G]=c.useState(d??"");c.useEffect(()=>{$(x??"")},[x]),c.useEffect(()=>{F(M??"")},[M]),c.useEffect(()=>{G(d??"")},[d]);const X=e.jsxs(He,{title:o("catalog.filters.title","Filters"),applyButtonText:o("catalog.filters.apply","Apply"),resetButtonText:o("catalog.filters.reset"),onApply:V,onReset:()=>{$(""),F(""),G(""),T([0,0]),m?.([0,0]),N?.()},children:[e.jsx(A,{title:o("common.search"),children:e.jsx(ee,{value:S,onChange:i=>{$(i),y?.(i)},placeholder:o("catalog.filters.search_placeholder","Company name..."),icon:"mdi:magnify",onKeyDown:i=>{i.key==="Enter"&&b?.(S)}})}),e.jsx(A,{title:o("catalog.filters.country","Country"),children:e.jsx(ee,{value:_,onChange:i=>{F(i),I?.(i)},placeholder:o("catalog.filters.country_placeholder","Georgia, USA..."),icon:"mdi:earth",onKeyDown:i=>{i.key==="Enter"&&V?.()}})}),e.jsx(A,{title:o("catalog.filters.city","City"),children:e.jsx(ee,{value:J,onChange:i=>{G(i),O?.(i)},placeholder:o("catalog.filters.city_placeholder","City"),icon:"mdi:map-marker",onKeyDown:i=>{i.key==="Enter"&&V?.()}})}),e.jsx(A,{title:o("catalog.filters.rating"),children:e.jsx(je,{value:P&&P>0?String(P):"0",onValueChange:i=>{const j=Number(i);Number.isNaN(j)||U?.(j)},options:[{value:"0",label:o("catalog.filters.rating_all")},{value:"3",label:`3+ ${o("common.stars")}`},{value:"4",label:`4+ ${o("common.stars")}`},{value:"5",label:`5 ${o("common.stars")}`}]})}),e.jsx(A,{title:o("catalog.filters.price"),children:e.jsx(Ne,{fromValue:g[0]>0?String(g[0]):"",toValue:g[1]>0?String(g[1]):"",onFromChange:i=>{const s=[Number(i)||0,g[1]];T(s),m?.(s)},onToChange:i=>{const j=Number(i)||0,s=[g[0],j];T(s),m?.(s)},showCurrencyPrefix:!0,inputMode:"numeric"})}),e.jsx(A,{title:o("catalog.filters.vip_only"),defaultOpen:!1,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-slate-50 px-1 py-0.5 rounded",children:[e.jsx(ye,{checked:!!C,onCheckedChange:i=>k?.(!!i),className:"h-3.5 w-3.5 rounded-sm"}),e.jsxs("span",{className:"text-[11px] text-slate-700 flex items-center gap-1",children:[o("catalog.filters.vip_only"),e.jsx(f,{icon:"mdi:crown",className:"h-3 w-3 text-amber-500"})]})]})})]}),Z=e.jsxs("div",{className:"bg-white",children:[e.jsx(A,{title:o("common.search"),children:e.jsx(ee,{value:S,onChange:i=>{$(i),y?.(i)},placeholder:o("catalog.filters.search_placeholder","Company name..."),icon:"mdi:magnify",onKeyDown:i=>{i.key==="Enter"&&b?.(S)}})}),e.jsx(A,{title:o("catalog.filters.country","Country"),children:e.jsx(ee,{value:_,onChange:i=>{F(i),I?.(i)},placeholder:o("catalog.filters.country_placeholder","Georgia, USA..."),icon:"mdi:earth",onKeyDown:i=>{i.key==="Enter"&&V?.()}})}),e.jsx(A,{title:o("catalog.filters.city_placeholder"),children:e.jsx(ee,{value:J,onChange:i=>{G(i),O?.(i)},placeholder:"თბილისი, ბათუმი...",icon:"mdi:map-marker",onKeyDown:i=>{i.key==="Enter"&&V?.()}})}),e.jsx(A,{title:o("catalog.filters.rating"),children:e.jsx(je,{value:P&&P>0?String(P):"0",onValueChange:i=>{const j=Number(i);Number.isNaN(j)||U?.(j)},options:[{value:"0",label:o("catalog.filters.rating_all")},{value:"3",label:`3+ ${o("common.stars")}`},{value:"4",label:`4+ ${o("common.stars")}`},{value:"5",label:`5 ${o("common.stars")}`}]})}),e.jsx(A,{title:o("catalog.filters.price"),children:e.jsx(Ne,{fromValue:g[0]>0?String(g[0]):"",toValue:g[1]>0?String(g[1]):"",onFromChange:i=>{const s=[Number(i)||0,g[1]];T(s),m?.(s)},onToChange:i=>{const j=Number(i)||0,s=[g[0],j];T(s),m?.(s)},showCurrencyPrefix:!0,inputMode:"numeric"})}),e.jsx(A,{title:o("catalog.filters.vip_only"),defaultOpen:!1,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-slate-50 px-1 py-0.5 rounded",children:[e.jsx(ye,{checked:!!C,onCheckedChange:i=>k?.(!!i),className:"h-3.5 w-3.5 rounded-sm"}),e.jsxs("span",{className:"text-[11px] text-slate-700 flex items-center gap-1",children:[o("catalog.filters.vip_only"),e.jsx(f,{icon:"mdi:crown",className:"h-3 w-3 text-amber-500"})]})]})})]});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:Y("hidden lg:block h-fit sticky top-24",h),children:X}),e.jsxs(Ie,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(D,{variant:"outline",className:"lg:hidden w-full h-12 border-slate-200 shadow-sm bg-white justify-between px-4 hover:bg-slate-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{icon:"mdi:filter-variant",className:"h-5 w-5 text-slate-700"}),e.jsx("span",{className:"font-semibold text-slate-900",children:o("catalog.filters.title","Filters")})]})})}),e.jsxs(De,{side:"left",className:"w-full sm:w-[400px] p-0 flex flex-col h-full bg-white",children:[e.jsx(Le,{className:"px-2 py-2 bg-primary text-white",children:e.jsxs(Me,{className:"text-left flex items-center gap-1.5 text-[11px] font-semibold uppercase tracking-wide text-white",children:[e.jsx(f,{icon:"mdi:filter-variant",className:"w-3.5 h-3.5"})," ",o("catalog.filters.title","Filters")]})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-white border-x border-slate-300",children:Z}),e.jsx(Ue,{className:"p-2 bg-slate-50 border-t border-slate-200",children:e.jsxs("div",{className:"flex flex-col gap-1.5 w-full",children:[e.jsx($e,{asChild:!0,children:e.jsx(D,{className:"w-full h-7 text-[10px] bg-accent hover:bg-accent/90 text-primary font-bold",onClick:V,children:o("catalog.filters.show_results","Show Results")})}),e.jsx(D,{variant:"outline",className:"w-full h-7 text-[10px] border-slate-300 text-slate-600 hover:bg-slate-100",onClick:()=>{$(""),F(""),G(""),T([0,0]),m?.([0,0]),N?.()},children:o("catalog.filters.reset")})]})})]})]})]})};function Ye({isOpen:h,onClose:x,companies:b}){const y=Math.max(...b.map(l=>l.rating)),M=Math.min(...b.map(l=>l.priceRange?.min??1/0)),I=Math.max(...b.map(l=>l.trustScore??0)),d=b.reduce((l,m)=>{const C=(m.trustScore??0)*100+m.rating*10;if(l===null)return m.id;const k=b.find(N=>N.id===l);if(!k)return m.id;const V=(k.trustScore??0)*100+k.rating*10;return C>V?m.id:l},null),O=({label:l})=>e.jsx("span",{className:"text-[8px] lg:text-[10px] font-semibold text-slate-600 uppercase tracking-tight leading-tight whitespace-pre-line break-words max-w-[68px] lg:max-w-[90px]",children:l}),P=l=>l?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(l):"—",U=[{label:"რეიტინგი",tooltip:"Average rating based on user reviews from Google and internal feedback.",icon:"mdi:star-circle",render:l=>e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:Y("flex items-center gap-1 font-bold text-sm lg:text-base",l.rating===y?"text-amber-500":"text-slate-700"),children:[e.jsx(f,{icon:"mdi:star",className:Y("h-3.5 w-3.5",l.rating===y?"text-amber-500":"text-slate-300")}),l.rating]}),e.jsxs("span",{className:"text-[9px] lg:text-[11px] text-slate-400 font-medium",children:[l.reviewCount," შეფასება"]})]})},{label:`სერვისის
საფასური`,tooltip:"The fixed fee charged by the company for their services (buying, documents, etc).",icon:"mdi:cash-multiple",render:l=>{const m=l.priceRange?.min===M;return e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("span",{className:Y("text-base lg:text-lg font-black tracking-tight",m?"text-emerald-600":"text-slate-900"),children:P(l.priceRange?.min)}),l.priceRange?.max&&e.jsxs("span",{className:"text-[8px] lg:text-[10px] text-slate-400 uppercase font-medium",children:["მაქსიმუმ ",P(l.priceRange.max)]}),m&&e.jsx(we,{className:"h-3 lg:h-4 text-[8px] lg:text-[10px] bg-emerald-100 text-emerald-700 hover:bg-emerald-100 border-none px-1.5",children:"საუკეთესო ფასი"})]})}},{label:`სანდოობის
ქულა`,icon:"mdi:shield-check",render:l=>{const m=l.trustScore??0,C=m>=90?"text-emerald-500":m>=70?"text-blue-500":"text-amber-500",k=m===I;return e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsxs("div",{className:"relative h-9 w-9",children:[e.jsxs("svg",{className:"h-full w-full -rotate-90",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"text-slate-100",strokeWidth:"2.5",stroke:"currentColor",fill:"transparent",r:"10",cx:"12",cy:"12"}),e.jsx("circle",{className:C,strokeWidth:"2.5",strokeDasharray:62.8,strokeDashoffset:62.8-62.8*m/100,strokeLinecap:"round",stroke:"currentColor",fill:"transparent",r:"10",cx:"12",cy:"12"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:Y("text-[10px] lg:text-xs font-bold",C),children:m})})]}),k&&e.jsx("span",{className:"text-[8px] lg:text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:"უმაღლესი სანდოობა"})]})}},{label:`მიწოდების
დრო`,tooltip:"Estimated time from US auction yard to Poti, Georgia.",icon:"mdi:clock-fast",render:()=>e.jsx("span",{className:"text-[10px] lg:text-xs font-bold text-slate-700 bg-slate-100 px-2 py-0.5 rounded-full",children:"45-60 დღე"})},{label:"გამოცდილება",tooltip:"Years the company has been officially registered and operating.",icon:"mdi:briefcase-clock",render:l=>e.jsx("div",{className:"text-xs lg:text-sm font-medium text-slate-600",children:l.establishedYear?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-bold text-slate-900",children:new Date().getFullYear()-l.establishedYear})," წელი"]}):e.jsx("span",{className:"text-slate-300",children:"-"})})},{label:`ოფიციალური
პარტნიორები`,tooltip:"Whether the company is an authorized broker for Copart or IAAI.",icon:"mdi:certificate",render:l=>l.vipStatus?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx(f,{icon:"mdi:checkbox-marked-circle",className:"h-4 w-4 text-emerald-500"}),e.jsx("span",{className:"text-[8px] lg:text-[10px] font-semibold text-slate-500 uppercase",children:"დადასტურებული ბროკერი"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx(f,{icon:"mdi:checkbox-blank-circle-outline",className:"h-4 w-4 text-slate-300"}),e.jsx("span",{className:"text-[8px] lg:text-[10px] font-semibold text-slate-400 uppercase",children:"სტანდარტული წვდომა"})]})},{label:`საწყისი
კონსულტაცია`,tooltip:"Is the initial consultation and calculation free?",icon:"mdi:human-greeting",render:l=>l.onboarding?.isFree?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx(f,{icon:"mdi:check-circle",className:"h-4 w-4 text-emerald-500"}),e.jsx("span",{className:"text-[9px] lg:text-[11px] font-bold text-emerald-700 uppercase tracking-wide",children:"უფასო კონსულტაცია"})]}):e.jsx("span",{className:"text-[10px] lg:text-xs text-slate-400 font-medium",children:"ფასიანი"})}];return e.jsx(ze,{children:h&&e.jsxs(be.div,{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 sm:p-6",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("div",{className:"absolute inset-0 bg-primary/60 backdrop-blur-sm",onClick:x}),e.jsxs(be.div,{className:"relative bg-white w-full max-w-4xl max-h-[90vh] rounded-2xl shadow-2xl shadow-primary/10 flex flex-col overflow-hidden border-2 border-primary/20",initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-sub to-accent rounded-t-2xl z-30"}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b border-slate-100 shrink-0 z-20 relative",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg text-blue-600",children:e.jsx(f,{icon:"mdi:compare-horizontal",className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"კომპანიების შედარება"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["ვადარებთ ",b.length," კომპანიას"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"hidden sm:flex items-center text-xs text-slate-500 mr-2",children:[e.jsx(f,{icon:"mdi:information-outline",className:"mr-1 h-3.5 w-3.5"}),e.jsx("span",{children:"გამოკვეთილი უჯრები საუკეთესო მნიშვნელობას აჩვენებს"})]}),e.jsx(D,{variant:"ghost",size:"icon",onClick:x,className:"rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-700",children:e.jsx(f,{icon:"mdi:close",className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto relative bg-slate-50/50",children:e.jsx("div",{className:"h-full",children:e.jsxs("div",{className:"min-w-max grid",style:{gridTemplateColumns:`120px repeat(${b.length}, minmax(120px, 1fr))`},children:[e.jsx("div",{className:"sticky top-0 left-0 z-30 bg-slate-50 border-b border-r border-slate-200 p-2.5 flex items-center justify-center",children:e.jsx(f,{icon:"mdi:format-list-bulleted-square",className:"h-4 w-4 text-slate-400"})}),b.map(l=>{const m=l.id===d;return e.jsxs("div",{className:"sticky top-0 z-20 bg-white border-b border-r border-slate-100 p-3 flex flex-col items-center gap-2.5 relative overflow-hidden",children:[m&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-amber-300 via-amber-500 to-amber-300"}),e.jsxs("div",{className:"relative h-10 w-10 group-hover:scale-105 transition-transform",children:[e.jsx("img",{src:l.logo??"",alt:l.name,className:"h-full w-full object-cover rounded-full shadow-sm"}),l.vipStatus&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-white rounded-full p-0.5 shadow-sm ring-1 ring-slate-50",children:e.jsx(f,{icon:"mdi:crown",className:"h-4 w-4 text-amber-500"})})]}),e.jsxs("div",{className:"text-center w-full",children:[e.jsx("h3",{className:"font-semibold text-slate-900 text-[9px] lg:text-xs leading-tight line-clamp-2 mb-0.5 break-words max-w-[80px] mx-auto",children:l.name}),m?e.jsxs(we,{className:"h-4 bg-amber-100 text-amber-800 hover:bg-amber-100 border-amber-200 text-[9px] font-bold shadow-sm",children:[e.jsx(f,{icon:"mdi:trophy",className:"mr-1 h-3 w-3"})," რეკომენდებული"]}):e.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs text-slate-500 h-5",children:[e.jsx(f,{icon:"mdi:map-marker",className:"h-3 w-3"}),l.location?.city||"საქართველო"]})]}),e.jsx(D,{size:"sm",variant:"outline",className:"h-7 px-2.5 text-[10px] font-semibold rounded-full border-slate-300 text-slate-700 bg-white hover:bg-slate-100 mt-1",onClick:()=>{window.open(`/company/${l.id}`,"_blank")},children:"არჩევა"})]},l.id)}),U.map(l=>e.jsxs("div",{className:"contents group",children:[e.jsxs("div",{className:"sticky left-0 z-10 bg-white border-r border-slate-200 border-b border-slate-100 px-1.5 py-1 flex items-center gap-1 group-hover:bg-slate-50/80 transition-colors",children:[e.jsx(f,{icon:l.icon,className:"h-3.5 w-3.5 text-slate-400 shrink-0"}),l.tooltip?e.jsx(O,{label:l.label,tooltip:l.tooltip}):e.jsx("span",{className:"text-[8px] font-semibold text-slate-600 uppercase tracking-tight whitespace-pre-line break-words max-w-[68px]",children:l.label})]}),b.map(m=>e.jsx("div",{className:"bg-white border-r border-slate-100 border-b border-slate-100 p-2 flex items-center justify-center group-hover:bg-slate-50/50 transition-colors relative",children:l.render(m)},`${m.id}-${l.label}`))]},l.label)),e.jsx("div",{className:"sticky left-0 z-10 bg-slate-50 border-r border-slate-200 p-2.5"}),b.map(l=>{const m=l.id===d;return e.jsx("div",{className:"bg-slate-50 border-r border-slate-200 p-2.5 flex items-center justify-center",children:e.jsx(D,{variant:m?"default":"outline",size:"icon",className:Y("rounded-full border-slate-300",m?"bg-emerald-500 text-white hover:bg-emerald-600 border-emerald-500 shadow-sm":"text-slate-500 hover:bg-slate-100 hover:text-slate-900"),children:e.jsx(f,{icon:"mdi:check-bold",className:"h-4 w-4"})})},`cta-${l.id}`)})]})})})]})]})})}const ke=[{value:"standard",label:"Standard"},{value:"heavy",label:"Heavy"}],_e=[{value:"Sedan",label:"Sedan"},{value:"Bike",label:"Bike"},{value:"Small SUV",label:"Small SUV"},{value:"Big SUV",label:"Big SUV"},{value:"Pickup",label:"Pickup"},{value:"Van",label:"Van"},{value:"Big Van",label:"Big Van"}],Se=h=>ke.some(x=>x.value===h),Pe=h=>_e.some(x=>x.value===h),Je=({className:h,initialValues:x,autoSubmit:b=!1,onCalculationComplete:y,onCalculationStart:M,onCalculationClear:I})=>{const{t:d}=he(),[O,P]=c.useState([]),[U,l]=c.useState([]),[m,C]=c.useState(!0),[k,V]=c.useState(!0),[N,o]=c.useState(x?.city??""),[g,T]=c.useState(x?.destinationPort??""),[S,$]=c.useState(x?.vehicleType&&Se(x.vehicleType)?x.vehicleType:"standard"),[_,F]=c.useState(x?.vehicleCategory&&Pe(x.vehicleCategory)?x.vehicleCategory:"Sedan");c.useEffect(()=>{x?.city&&o(x.city),x?.destinationPort&&T(x.destinationPort),x?.vehicleType&&Se(x.vehicleType)&&$(x.vehicleType),x?.vehicleCategory&&Pe(x.vehicleCategory)&&F(x.vehicleCategory)},[x]);const[J,G]=c.useState(!1),[X,Z]=c.useState(!1),[i,j]=c.useState(null),[s,B]=c.useState(null);c.useEffect(()=>{let n=!1;return(async()=>{try{C(!0);const p=await ve("/cities");!n&&p.success&&P(p.data)}catch{}finally{n||C(!1)}})(),()=>{n=!0}},[]),c.useEffect(()=>{let n=!1;return(async()=>{try{V(!0);const p=await ve("/ports");!n&&p.success&&l(p.data)}catch{}finally{n||V(!1)}})(),()=>{n=!0}},[]);const R=()=>N?N.length>30?d("calculator.errors.city_too_long","City name is too long (max 30 characters)"):g?g.length>30?d("calculator.errors.port_too_long","Port name is too long (max 30 characters)"):!S||!["standard","heavy"].includes(S)?d("calculator.errors.vehicle_type_required","Please select a vehicle type"):!_||!["Sedan","Bike","Small SUV","Big SUV","Pickup","Van","Big Van"].includes(_)?d("calculator.errors.vehicle_category_required","Please select a vehicle category"):null:d("calculator.errors.port_required","Please select a destination port"):d("calculator.errors.city_required","Please select a city"),z=async()=>{j(null),B(null),I?.();const n=R();if(n){j(n);return}const te={usacity:N.trim(),destinationport:g.trim(),vehicletype:S,vehiclecategory:_,auction:"Copart"};try{Z(!0),M?.();const p=await qe("/calculator/quotes",te);B(p),y?.(p,{city:N,destinationPort:g,vehicleType:S,vehicleCategory:_})}catch(p){const w=p instanceof Error?p.message:d("calculator.errors.calculation_failed","Calculation failed. Please try again.");j(w),I?.()}finally{Z(!1)}};c.useEffect(()=>{b&&!J&&!m&&!k&&N&&g&&S&&_&&(G(!0),z())},[b,J,m,k,N,g,S,_]);const H=N&&g&&S&&_;return e.jsxs("div",{className:`rounded-md border border-slate-200 bg-white shadow-sm px-5 py-4 ${h??""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{icon:"mdi:calculator-variant",className:"h-4 w-4 text-primary"}),e.jsx("h2",{className:"text-base font-semibold text-primary",children:d("calculator.title","Shipping Calculator")})]}),e.jsx("p",{className:"hidden md:block text-xs text-muted-foreground",children:d("calculator.helper_text","Price appears in the company list below.")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs(ne,{htmlFor:"calc-city",className:"text-xs font-medium text-muted-foreground mb-1 block",children:[d("calculator.city","City")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),m?e.jsx(q,{className:"h-9 w-full"}):e.jsxs(ae,{value:N,onValueChange:o,children:[e.jsx(le,{id:"calc-city",className:"w-full h-9 text-sm",children:e.jsx(re,{placeholder:d("calculator.select_city","Select city...")})}),e.jsxs(ce,{className:"max-h-60",children:[N&&!O.includes(N)&&e.jsx(W,{value:N,className:"text-sm",children:N},N),O.filter(n=>n&&n.trim().length>0).map(n=>e.jsx(W,{value:n,className:"text-sm",children:n},n))]})]})]}),e.jsxs("div",{children:[e.jsxs(ne,{htmlFor:"calc-port",className:"text-xs font-medium text-muted-foreground mb-1 block",children:[d("calculator.destination_port","Destination Port")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),k?e.jsx(q,{className:"h-9 w-full"}):e.jsxs(ae,{value:g,onValueChange:T,children:[e.jsx(le,{id:"calc-port",className:"w-full h-9 text-sm",children:e.jsx(re,{placeholder:d("calculator.select_port","Select port...")})}),e.jsxs(ce,{className:"max-h-60",children:[g&&!U.includes(g)&&e.jsx(W,{value:g,className:"text-sm",children:d(`calculator.ports.${g}`,g)},g),U.filter(n=>n&&n.trim().length>0).map(n=>e.jsx(W,{value:n,className:"text-sm",children:d(`calculator.ports.${n}`,n)},n))]})]})]}),e.jsxs("div",{children:[e.jsxs(ne,{htmlFor:"calc-vehicle-type",className:"text-xs font-medium text-muted-foreground mb-1 block",children:[d("calculator.vehicle_type","Vehicle Type")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(ae,{value:S,onValueChange:n=>$(n),children:[e.jsx(le,{id:"calc-vehicle-type",className:"w-full h-9 text-sm",children:e.jsx(re,{placeholder:d("calculator.select_vehicle_type","Select type...")})}),e.jsx(ce,{children:ke.map(n=>e.jsx(W,{value:n.value,className:"text-sm",children:d(`calculator.vehicle_types.${n.value}`,n.label)},n.value))})]})]}),e.jsxs("div",{children:[e.jsxs(ne,{htmlFor:"calc-vehicle-category",className:"text-xs font-medium text-muted-foreground mb-1 block",children:[d("calculator.vehicle_category","Vehicle Category")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(ae,{value:_,onValueChange:n=>F(n),children:[e.jsx(le,{id:"calc-vehicle-category",className:"w-full h-9 text-sm",children:e.jsx(re,{placeholder:d("calculator.select_vehicle_category","Select category...")})}),e.jsx(ce,{children:_e.map(n=>e.jsx(W,{value:n.value,className:"text-sm",children:d(`calculator.vehicle_categories.${n.value}`,n.label)},n.value))})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[e.jsx("p",{className:"md:hidden text-xs text-muted-foreground",children:d("calculator.helper_text","Price appears in the company list below.")}),e.jsx(D,{onClick:z,disabled:!H||X,className:"w-full md:w-auto md:min-w-[180px] flex items-center justify-center gap-2 bg-[#101B3D] hover:bg-[#0c142f]",children:X?e.jsxs(e.Fragment,{children:[e.jsx(f,{icon:"mdi:loading",className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:d("calculator.calculating","Calculating...")})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{icon:"mdi:calculator",className:"h-4 w-4"}),e.jsx("span",{children:d("calculator.calculate","Calculate")})]})})]}),i&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-red-50 px-3 py-2 text-xs text-red-700",children:[e.jsx(f,{icon:"mdi:alert-circle",className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:i})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-emerald-50 px-3 py-2 text-xs text-emerald-700",children:[e.jsx(f,{icon:"mdi:check-circle",className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:d("calculator.price_shown_in_list","Price is displayed in the company list below.")})]})]})]})},ct=()=>{const{t:h}=he(),x=Oe(),[b,y]=c.useState(1),M=()=>{y(1)},I=12,[d,O]=c.useState([]),[P,U]=c.useState(!0),[l,m]=c.useState(!1),[C,k]=c.useState([]),[V,N]=c.useState(!1),[o,g]=c.useState(new Map),[T,S]=c.useState(null),[$,_]=c.useState(!1),[F,J]=c.useState(!1),[G]=c.useState(()=>{const t=new URLSearchParams(window.location.search),a=t.get("calc_city")??"",r=t.get("calc_port")??"",u=t.get("calc_type")??"",v=t.get("calc_category")??"";if(a&&r&&u&&v)return{city:a,destinationPort:r,vehicleType:u,vehicleCategory:v}}),[X]=c.useState(()=>{const t=new URLSearchParams(window.location.search),a=t.get("calc_city")??"",r=t.get("calc_port")??"",u=t.get("calc_type")??"",v=t.get("calc_category")??"";return!!(a&&r&&u&&v)}),[Z,i]=c.useState(null),j={search:"",country:"",city:"",minRating:void 0,minBasePrice:void 0,maxBasePrice:void 0,isVip:!1,orderBy:"rating"},[s,B]=c.useState(j),R=c.useRef(""),z=c.useRef(""),H=c.useRef(""),n=c.useRef([0,0]),te=t=>{k(a=>a.includes(t)?a.filter(r=>r!==t):a.length>=3?a:[...a,t])},p=c.useCallback(async(t,a)=>{U(!0);try{const r=(t-1)*I,{companies:u,total:v}=await We({limit:I,offset:r,search:a.search||void 0,country:a.country||void 0,city:a.city||void 0,minRating:typeof a.minRating=="number"&&a.minRating>0?a.minRating:void 0,minBasePrice:typeof a.minBasePrice=="number"&&a.minBasePrice>0?a.minBasePrice:void 0,orderBy:a.orderBy!=="rating"?a.orderBy:void 0,maxBasePrice:typeof a.maxBasePrice=="number"&&a.maxBasePrice>0?a.maxBasePrice:void 0,isVip:a.isVip===!0});O(u),i(typeof v=="number"?v:u.length),y(t)}catch{}finally{U(!1)}},[I]),w=c.useCallback((t,a)=>{if(typeof window>"u")return;const r=new URLSearchParams(window.location.search),u=t.search.trim();u.length>0?r.set("q",u):r.delete("q");const v=t.country.trim();v.length>0?r.set("country",v):r.delete("country");const E=t.city.trim();E.length>0?r.set("city",E):r.delete("city"),t.orderBy&&t.orderBy!=="rating"?r.set("sort",t.orderBy):r.delete("sort"),typeof t.minRating=="number"&&t.minRating>0?r.set("min_rating",String(t.minRating)):r.delete("min_rating"),t.isVip?r.set("is_vip","true"):r.delete("is_vip"),typeof t.minBasePrice=="number"&&t.minBasePrice>0?r.set("min_price",String(t.minBasePrice)):r.delete("min_price"),typeof t.maxBasePrice=="number"&&t.maxBasePrice>0?r.set("max_price",String(t.maxBasePrice)):r.delete("max_price"),a>1?r.set("page",String(a)):r.delete("page");const Q=r.toString(),L=Q.length>0?`?${Q}`:"",ie=`${x.pathname}${L}`;window.history.replaceState(null,"",ie)},[x.pathname]);c.useEffect(()=>{const t=new URLSearchParams(window.location.search),a=(t.get("q")??"").trim(),r=(t.get("country")??"").trim(),u=(t.get("city")??"").trim(),v=t.get("min_rating"),E=v?Number(v):void 0,L=t.get("is_vip")==="true",ie=t.get("min_price"),pe=t.get("max_price"),de=ie?Number(ie):void 0,me=pe?Number(pe):void 0,xe=t.get("sort"),Fe=xe==="newest"||xe==="cheapest"?xe:"rating",ge=t.get("page"),Ee=ge?Math.max(1,parseInt(ge,10)||1):1,fe={search:a,country:r,city:u,minRating:Number.isNaN(E)?void 0:E,minBasePrice:Number.isNaN(de)?void 0:de,maxBasePrice:Number.isNaN(me)?void 0:me,isVip:L,orderBy:Fe};B(fe),R.current=a,z.current=r,H.current=u,n.current=[de??0,me??0],p(Ee,fe)},[p]);const se=Z??d.length,K=se>0?Math.ceil(se/I):1,ue=K===0?1:Math.min(b,K),oe=c.useMemo(()=>d,[d]),Be=c.useCallback((t,a)=>{const r=new Map;if(t.quotes&&Array.isArray(t.quotes))for(const Q of t.quotes)r.set(Q.companyId,Q.totalPrice);g(r);const u=t.defaultPrice??t.data?.transportation_total??t.transportation_total??null;S(u),J(!0),_(!1);const v=new URLSearchParams(window.location.search);v.set("calc_city",a.city),v.set("calc_port",a.destinationPort),v.set("calc_type",a.vehicleType),v.set("calc_category",a.vehicleCategory);const E=`${x.pathname}?${v.toString()}`;window.history.replaceState(null,"",E)},[x.pathname]),Re=c.useCallback(()=>{_(!0)},[]),Ve=c.useCallback(()=>{g(new Map),S(null),J(!1),_(!1)},[]),Te=c.useMemo(()=>e.jsxs(e.Fragment,{children:[F&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 bg-white p-3 border border-slate-200",children:[e.jsxs("p",{className:"text-[12px] font-medium text-slate-600",children:[h("catalog.results.showing")," ",e.jsx("span",{className:"font-bold text-slate-900",children:oe.length})," ",h("catalog.results.connector")," ",e.jsx("span",{className:"font-bold text-slate-900",children:se})," ",h("catalog.results.of")]}),e.jsx("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto sm:justify-end",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 sm:ml-auto",children:[e.jsx("span",{className:"text-[11px] text-slate-500 whitespace-nowrap hidden sm:inline",children:h("catalog.results.sort_label")}),e.jsxs(ae,{value:s.orderBy,onValueChange:t=>{if(t===s.orderBy)return;const a={...s,orderBy:t};B(a),y(1),p(1,a),w(a,1)},children:[e.jsx(le,{className:"w-auto min-w-[120px] sm:w-[160px] h-7 text-[11px] bg-white border-slate-200",children:e.jsx(re,{})}),e.jsxs(ce,{children:[e.jsx(W,{value:"rating",className:"text-[11px]",children:h("catalog.sort.rating")}),e.jsx(W,{value:"cheapest",className:"text-[11px]",children:h("catalog.sort.cheapest")}),e.jsx(W,{value:"newest",className:"text-[11px]",children:h("catalog.sort.newest")})]})]})]})})]}),F?P?e.jsx("div",{className:"grid gap-3 xl:gap-4 grid-cols-1",children:[1,2,3,4,5,6].map(t=>e.jsxs("div",{className:"rounded-md border border-slate-200 bg-white shadow-sm px-4 py-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{className:"h-12 w-12 xl:h-14 xl:w-14 rounded-2xl shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(q,{className:"h-4 w-28"}),e.jsx(q,{className:"h-3 w-16"})]})]}),e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(q,{className:"h-3 w-20"}),e.jsx(q,{className:"h-3 w-16"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-3 w-12"}),e.jsxs("div",{className:"ml-auto flex gap-1.5",children:[e.jsx(q,{className:"h-7 w-16"}),e.jsx(q,{className:"h-7 w-16"})]})]})]},t))}):se>0?e.jsx("div",{className:"grid gap-3 xl:gap-4 grid-cols-1",children:oe.map(t=>e.jsx(Ke,{company:t,isCompareMode:l,isSelected:C.includes(t.id),onToggleCompare:()=>te(t.id),hasAuctionBranch:F,calculatedShippingPrice:o.get(t.id)??T??void 0},t.id))}):e.jsx(Ge,{title:h("catalog.results.empty_title"),description:h("catalog.results.empty_description"),icon:"mdi:clipboard-text-off-outline",action:e.jsx(D,{onClick:M,variant:"outline",children:h("catalog.filters.reset")})}):e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:h("catalog.results.use_calculator_title","Companies will appear here")}),e.jsx("p",{className:"text-xs text-muted-foreground/60 mt-1",children:h("catalog.results.use_calculator_hint","Fill in the calculator to see offers")})]}),!P&&K>1&&e.jsxs("div",{className:"flex justify-center items-center gap-1 mt-6",children:[e.jsx(D,{id:"catalog-prev-page",type:"button",variant:"outline",size:"sm",onClick:()=>{if(b<=1)return;const t=b-1;y(t),p(t,s),w(s,t),window.scrollTo({top:0,behavior:"smooth"})},disabled:b<=1,"aria-disabled":b<=1,className:Y("h-7 w-7 p-0 flex items-center justify-center text-[11px] transition-all",b<=1?"border-slate-200 text-slate-400 bg-transparent cursor-not-allowed":"border-slate-300 text-slate-600 bg-white hover:bg-slate-50"),children:e.jsx(f,{icon:"mdi:chevron-left",className:"h-4 w-4"})}),e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:K},(t,a)=>a+1).map(t=>{const a=t===ue;return e.jsx("button",{type:"button",onClick:()=>{a||(y(t),p(t,s),w(s,t),window.scrollTo({top:0,behavior:"smooth"}))},"aria-current":a?"page":void 0,className:Y("h-7 min-w-[28px] px-2 text-[11px] font-medium transition-all border flex items-center justify-center",a?"bg-primary border-primary text-white":"bg-white border-slate-200 text-slate-700 hover:bg-slate-50"),children:t},t)})}),e.jsx(D,{id:"catalog-next-page",type:"button",variant:"outline",size:"sm",onClick:()=>{if(b>=K)return;const t=b+1;y(t),p(t,s),w(s,t),window.scrollTo({top:0,behavior:"smooth"})},disabled:b>=K,"aria-disabled":b>=K,className:Y("h-7 w-7 p-0 flex items-center justify-center text-[11px] transition-all",b>=K?"border-slate-200 text-slate-400 bg-transparent cursor-not-allowed":"border-slate-300 text-slate-600 bg-white hover:bg-slate-50"),children:e.jsx(f,{icon:"mdi:chevron-right",className:"h-4 w-4"})})]})]}),[h,oe,se,l,C,P,K,ue,M,b,s,p,w,F,$,o,T]);return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:"bg-white border-b border-slate-200",children:e.jsxs("div",{className:"w-full max-w-[1400px] mx-auto px-4 py-4",children:[e.jsx("h1",{className:"text-xl font-bold text-slate-900",children:h("catalog.title")}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:h("catalog.subtitle")})]})}),e.jsx("main",{className:"w-full max-w-[1400px] mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("aside",{className:"hidden lg:block w-[240px] flex-shrink-0 sticky top-4",children:e.jsx(Ce,{initialSearch:s.search,initialCountry:s.country,initialCity:s.city,initialMinRating:s.minRating,initialPriceRange:[s.minBasePrice??0,s.maxBasePrice??0],initialIsVip:s.isVip,onSearchChange:t=>{R.current=t},onCountryChange:t=>{z.current=t},onCityChange:t=>{H.current=t},onPriceRangeChange:t=>{n.current=t},onApplyFilters:()=>{const t=R.current.trim(),a=z.current.trim(),r=H.current.trim(),u=n.current,v=u[0]>0?u[0]:void 0,E=u[1]>0?u[1]:void 0;if(!(t!==s.search||a!==s.country||r!==s.city||v!==s.minBasePrice||E!==s.maxBasePrice))return;const L={...s,search:t,country:a,city:r,minBasePrice:v,maxBasePrice:E};B(L),y(1),p(1,L),w(L,1)},onResetFilters:()=>{s.search===""&&s.country===""&&s.city===""&&s.minRating===void 0&&s.minBasePrice===void 0&&s.maxBasePrice===void 0&&s.isVip===!1&&s.orderBy==="rating"||(R.current="",z.current="",H.current="",n.current=[0,0],B(j),y(1),p(1,j),w(j,1))},onSearchSubmit:t=>{const a=t.trim();R.current=a;const r={...s,search:a};B(r),y(1),p(1,r),w(r,1)},onMinRatingChange:t=>{const a=t>0?t:void 0,r=R.current??s.search,u={...s,search:r,minRating:a};B(u),y(1),p(1,u),w(u,1)},onVipChange:t=>{const a=R.current??s.search,r={...s,search:a,isVip:t};B(r),y(1),p(1,r),w(r,1)}})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-4",children:[e.jsx("div",{className:"lg:hidden",children:e.jsx(Ce,{initialSearch:s.search,initialCountry:s.country,initialCity:s.city,initialMinRating:s.minRating,initialPriceRange:[s.minBasePrice??0,s.maxBasePrice??0],initialIsVip:s.isVip,onSearchChange:t=>{R.current=t},onCountryChange:t=>{z.current=t},onCityChange:t=>{H.current=t},onPriceRangeChange:t=>{n.current=t},onApplyFilters:()=>{const t=R.current.trim(),a=z.current.trim(),r=H.current.trim(),u=n.current,v=u[0]>0?u[0]:void 0,E=u[1]>0?u[1]:void 0;if(!(t!==s.search||a!==s.country||r!==s.city||v!==s.minBasePrice||E!==s.maxBasePrice))return;const L={...s,search:t,country:a,city:r,minBasePrice:v,maxBasePrice:E};B(L),y(1),p(1,L),w(L,1)},onResetFilters:()=>{s.search===""&&s.country===""&&s.city===""&&s.minRating===void 0&&s.minBasePrice===void 0&&s.maxBasePrice===void 0&&s.isVip===!1&&s.orderBy==="rating"||(R.current="",z.current="",H.current="",n.current=[0,0],B(j),y(1),p(1,j),w(j,1))},onSearchSubmit:t=>{const a=t.trim();R.current=a;const r={...s,search:a};B(r),y(1),p(1,r),w(r,1)},onMinRatingChange:t=>{const a=t>0?t:void 0,r=R.current??s.search,u={...s,search:r,minRating:a};B(u),y(1),p(1,u),w(u,1)},onVipChange:t=>{const a=R.current??s.search,r={...s,search:a,isVip:t};B(r),y(1),p(1,r),w(r,1)}})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(Je,{initialValues:G,autoSubmit:X,onCalculationComplete:Be,onCalculationStart:Re,onCalculationClear:Ve}),e.jsxs("div",{className:"rounded-md border border-slate-200 bg-white shadow-sm px-5 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(f,{icon:"mdi:information-outline",className:"h-4 w-4 text-primary"}),e.jsx("h3",{className:"text-base font-semibold text-primary",children:h("calculator.info.title","How It Works")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:h("calculator.info.description","Use this calculator to estimate shipping and import costs for your vehicle from the USA to Georgia.")}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(f,{icon:"mdi:check-circle",className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:h("calculator.info.point1","Select your pickup city and destination port")})]}),e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(f,{icon:"mdi:check-circle",className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:h("calculator.info.point2","Choose your vehicle type and category")})]}),e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(f,{icon:"mdi:check-circle",className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:h("calculator.info.point3","Compare prices from multiple import companies")})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-100",children:e.jsx("p",{className:"text-xs text-muted-foreground/80 italic",children:h("calculator.info.disclaimer","Prices are indicative estimates and may vary based on actual conditions.")})})]})]}),Te]})]})}),C.length>0&&e.jsxs("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-1.5 items-end",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>{k([]),m(!1)},className:"shadow-md bg-white hover:bg-slate-50 text-slate-600 border-slate-300 h-7 text-[11px] px-3",children:[e.jsx(f,{icon:"mdi:close",className:"h-3.5 w-3.5 mr-1"}),h("catalog.comparison.cancel")]}),e.jsxs(D,{onClick:()=>N(!0),className:"bg-primary hover:bg-primary/90 text-white shadow-lg px-4 h-10 flex items-center gap-2 transition-all text-[12px] font-semibold",children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{icon:"mdi:compare-horizontal",className:"h-5 w-5"}),e.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-accent text-primary text-[9px] font-bold h-4 w-4 flex items-center justify-center rounded-full",children:C.length})]}),e.jsx("span",{children:h("catalog.comparison.compare_now")})]})]}),e.jsx(Ye,{isOpen:V,onClose:()=>N(!1),companies:d.filter(t=>C.includes(t.id))})]})};export{ct as default};
