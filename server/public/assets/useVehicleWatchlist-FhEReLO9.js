import{aG as m,as as d,x as p,r}from"./index-zfRgVEOB.js";async function g(s=1,n=20){const e=new URLSearchParams;return e.set("page",String(s)),e.set("limit",String(n)),m(`/favorites/vehicles?${e.toString()}`)}async function y(s){return d("POST",`/favorites/vehicles/${s}`)}async function E(s){return d("DELETE",`/favorites/vehicles/${s}`)}function A(){const{user:s,isAuthenticated:n}=p(),[e,o]=r.useState(new Set),[h,l]=r.useState(!1),[S,f]=r.useState(null);r.useEffect(()=>{if(!n||!s){o(new Set);return}let t=!0;return l(!0),f(null),(async()=>{try{const i=await g(1,100);if(!t)return;const a=new Set(i.items.map(c=>c.id));o(a)}catch{if(!t)return;f("Failed to load watchlist")}finally{t&&l(!1)}})(),()=>{t=!1}},[n,s]);const w=r.useCallback(t=>e.has(t),[e]),W=r.useCallback(async t=>{if(!n)return;const u=e.has(t);o(i=>{const a=new Set(i);return u?a.delete(t):a.add(t),a});try{u?await E(t):await y(t)}catch{o(a=>{const c=new Set(a);return u?c.add(t):c.delete(t),c})}},[n,e]);return{watchedIds:e,isWatched:w,toggleWatch:W,isLoading:h,error:S}}export{g as f,A as u};
