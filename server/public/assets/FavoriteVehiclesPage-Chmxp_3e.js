import{a as B,j as e,c as C,B as u,I as v,b as I,r as p,S as N,A as M,m as A}from"./index-B94BBDmk.js";import{C as z,c as E}from"./card-DWHG4ITx.js";import{u as F,T as P,d as T}from"./useCalculateVehicleQuotes-CIL_qf8Y.js";import{C as q}from"./checkbox-C2QIUhyP.js";import{a as U}from"./formatDate-BODqZ6W4.js";import{u as W,f as Q}from"./useVehicleWatchlist-zYEDItwz.js";const $=s=>{if(s==null)return"$0";const n=typeof s=="number"?s:Number(s);return Number.isFinite(n)?`$${n.toLocaleString()}`:"$0"};function D({item:s,isSelected:n=!1,onToggleSelect:L,onViewDetails:d,showCompareCheckbox:w=!1,priority:c=!1,onToggleWatch:y,isWatched:f=!1,hideExtraColumns:_=!1}){const{t:r,i18n:b}=B(),g=s.primary_photo_url||s.primary_thumb_url||"/cars/1.webp",h=s.last_bid;let j=null,m=null;if(h&&h.bid!=null)j=h.bid,m=h.bid_time;else if(s.calc_price!=null){const t=typeof s.calc_price=="number"?s.calc_price:Number(s.calc_price);Number.isFinite(t)&&(j=t)}const k=t=>{if(!t)return"";try{return U(t,b.language,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}};let x=null;if(s.buy_it_now_price!=null){const t=typeof s.buy_it_now_price=="number"?s.buy_it_now_price:Number(s.buy_it_now_price);Number.isFinite(t)&&t>0&&(x=t)}else if(s.buy_it_now!=null){const t=typeof s.buy_it_now=="number"?s.buy_it_now:Number(s.buy_it_now);Number.isFinite(t)&&t>0&&(x=t)}const S=x!=null,l=s.retail_value?typeof s.retail_value=="number"?s.retail_value:Number(s.retail_value):null;return e.jsxs("tr",{className:C("hover:bg-muted/50 border-b transition-colors",n&&"bg-muted"),children:[e.jsx("td",{className:"align-top whitespace-normal lg:whitespace-nowrap break-words p-2 responsive-image-cell px-1 overflow-visible",children:e.jsxs("div",{className:"flex gap-2",children:[w&&e.jsx("div",{className:"flex items-start pt-1",children:e.jsx(q,{checked:n,onCheckedChange:t=>L?.(t===!0),className:"h-4 w-4"})}),e.jsxs("div",{className:C("relative aspect-[4/3] rounded-md overflow-hidden bg-muted responsive-image",w?"w-[140px]":"w-48"),children:[e.jsx("button",{type:"button",className:"w-full h-full focus:outline-none focus:ring-2 focus:ring-ring cursor-pointer",onClick:d,children:e.jsx("img",{src:g,alt:`${s.year} ${s.make} ${s.model}`,className:"w-full h-full object-cover",loading:c?"eager":"lazy"})}),s.source&&e.jsx("div",{className:C("absolute bottom-1 right-1 px-1 py-0.5 rounded text-[8px] font-bold uppercase text-white",s.source.toLowerCase()==="copart"?"bg-[#002d72]":"bg-[#c41230]"),children:s.source.toLowerCase()==="copart"?"Copart":"IAAI"})]})]})}),e.jsx("td",{className:"align-top whitespace-normal lg:whitespace-nowrap break-words p-2 overflow-hidden",children:e.jsxs("div",{className:"max-w-[140px] pl-2",children:[e.jsx("button",{onClick:d,className:"text-left",children:e.jsxs("h3",{className:"font-semibold text-xs text-primary hover:underline leading-tight uppercase whitespace-normal break-words",children:[s.year," ",s.make," ",s.model]})}),e.jsxs("div",{className:"text-muted-foreground mt-0.5 text-[11px]",children:[r("auction.lot")," ",e.jsx("span",{className:"text-primary font-medium",children:s.source_lot_id||"N/A"})]}),s.yard_name&&e.jsx("div",{className:"mt-0.5 text-[11px] text-muted-foreground truncate",title:s.yard_name,children:s.yard_name}),e.jsx("div",{className:"flex items-center gap-1 mt-2",children:y&&e.jsxs(u,{variant:f?"default":"outline",size:"sm",className:C("h-6 text-[10px] gap-1",f&&"bg-green-600 hover:bg-green-700"),onClick:t=>{t.stopPropagation(),y()},children:[e.jsx(v,{icon:"mdi:bookmark",className:"w-3 h-3"}),r(f?"auction.actions.watched":"auction.actions.watch")]})})]})}),!_&&e.jsx("td",{className:"align-top whitespace-normal lg:whitespace-nowrap break-words p-2 overflow-hidden",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-muted-foreground text-[11px]",children:r("auction.fields.odometer")}),e.jsx("div",{className:"font-semibold text-foreground",children:s.mileage?s.mileage.toLocaleString():"N/A"}),e.jsx("div",{className:"text-muted-foreground mt-1.5 text-[11px]",children:r("auction.fields.estimated_retail_value")}),e.jsx("div",{className:"font-semibold text-foreground",children:l?$(l):"N/A"})]})}),!_&&e.jsx("td",{className:"align-top whitespace-normal lg:whitespace-nowrap break-words p-2 overflow-hidden",children:e.jsx("div",{className:"text-foreground font-medium text-[11px]",children:s.document||"N/A"})}),e.jsx("td",{className:"align-top whitespace-normal lg:whitespace-nowrap break-words p-2 overflow-hidden",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-muted-foreground text-[10px]",children:r("auction.fields.current_bid")}),e.jsxs("div",{className:"text-base font-bold text-foreground",children:[$(j)," ",e.jsx("span",{className:"text-xs font-normal text-muted-foreground",children:"USD"})]}),m&&e.jsx("div",{className:"text-[9px] text-muted-foreground mb-1.5",children:k(m)}),!m&&e.jsx("div",{className:"mb-2"}),e.jsx(u,{size:"sm",className:"w-full h-7 text-[11px] bg-primary hover:bg-primary/90 text-white font-semibold mb-1.5",onClick:d,children:r("auction.actions.bid_now")}),S?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{size:"sm",className:"h-7 px-3 text-[11px] bg-accent hover:bg-accent/90 text-primary font-semibold",onClick:d,children:r("auction.actions.buy_it_now")}),e.jsxs("span",{className:"text-sm text-foreground font-semibold",children:[$(x)," ",e.jsx("span",{className:"text-xs font-normal text-muted-foreground",children:"USD"})]})]}):e.jsx(u,{size:"sm",variant:"outline",className:"w-full h-7 text-[11px] border-primary text-primary hover:bg-primary/5",onClick:d,children:r("common.details")})]})})]})}const K=()=>{const{t:s}=B(),n=I(),{isWatched:L,toggleWatch:d,isLoading:w}=W(),{data:c,isLoading:y,error:f,calculateQuotes:_}=F(),[r,b]=p.useState(!1),[g,h]=p.useState([]),[j,m]=p.useState(!1),[k,x]=p.useState(null);p.useEffect(()=>{let a=!0;return m(!0),x(null),Q(1,100).then(o=>{a&&h(o.items)}).catch(o=>{a&&x("Failed to load favorite vehicles")}).finally(()=>{a&&m(!1)}),()=>{a=!1}},[]);const S=j||w,l=p.useMemo(()=>{if(!c||!c.quotes||c.quotes.length===0)return null;const a=Math.floor(Math.random()*c.quotes.length);return c.quotes[a]},[c]),t=(a,o="USD")=>{if(a==null)return null;const i=typeof a=="number"?a:Number(a);return Number.isFinite(i)?o==="GEL"?`${i.toLocaleString()} GEL`:`$${i.toLocaleString()}`:null};return e.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[e.jsxs("main",{className:"flex-1 flex flex-col",role:"main","aria-label":s("auction.favorite_vehicles"),children:[e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-slate-900 tracking-tight mb-2",children:s("auction.favorite_vehicles")}),e.jsx("p",{className:"text-lg text-slate-600 max-w-2xl",children:s("auction.favorite_vehicles_description")})]})})}),e.jsx("div",{className:"flex-1 container mx-auto px-4 py-8",children:e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"min-h-[400px]",children:S&&g.length===0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2 sm:gap-5",children:Array.from({length:8}).map((a,o)=>e.jsxs(z,{className:"overflow-hidden rounded-xl border-border/50 flex flex-row sm:flex-col",children:[e.jsx(N,{className:"w-28 h-20 sm:w-full sm:aspect-[4/3] sm:h-auto flex-shrink-0"}),e.jsxs(E,{className:"p-2 sm:p-4 space-y-1 sm:space-y-3 flex-1",children:[e.jsx(N,{className:"h-4 sm:h-5 w-3/4"}),e.jsx(N,{className:"h-3 sm:h-4 w-1/2"}),e.jsxs("div",{className:"flex justify-between pt-1 sm:pt-2",children:[e.jsx(N,{className:"h-6 sm:h-8 w-16 sm:w-20"}),e.jsx(N,{className:"h-6 sm:h-8 w-14 sm:w-8 rounded-full"})]})]})]},o))}):k?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4 border rounded-xl bg-destructive/5 border-destructive/20",children:[e.jsx(v,{icon:"mdi:alert-circle-outline",className:"w-12 h-12 text-destructive"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-destructive",children:s("error.failed_to_load_data")}),e.jsx("p",{className:"text-muted-foreground",children:k})]}),e.jsx(u,{variant:"outline",onClick:()=>window.location.reload(),children:s("common.retry")})]}):g.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4 border rounded-xl bg-muted/30 border-dashed",children:[e.jsx(v,{icon:"mdi:star-outline",className:"w-12 h-12 text-muted-foreground/50"}),e.jsx("div",{className:"space-y-1",children:e.jsx("h3",{className:"font-semibold text-lg",children:s("auction.no_favorites")})}),e.jsx(u,{variant:"outline",onClick:()=>n({pathname:"/auction-listings"}),children:s("auction.browse_auctions")})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map((a,o)=>e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsx(P,{children:e.jsx(T,{children:e.jsx(D,{item:a,priority:o<4,isSelected:!1,showCompareCheckbox:!1,isWatched:L(a.vehicle_id??a.id),hideExtraColumns:!0,onToggleWatch:()=>{const i=a.vehicle_id??a.id;d(i)},onCalculate:()=>{const i=a.vehicle_id??a.id;b(!0),_(i)},onViewDetails:()=>{const i=a.vehicle_id??a.id;n({pathname:`/vehicle/${i}`})}})})})},`${a.id}-${a.vehicle_id}`))})})})})]}),e.jsx(M,{children:r&&e.jsx(A.div,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(!1),children:e.jsxs(A.div,{className:"bg-background rounded-xl shadow-xl w-full max-w-md overflow-hidden",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s("auction.calculate_cost")}),e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>b(!1),children:e.jsx(v,{icon:"mdi:close",className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6",children:y?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(v,{icon:"mdi:calculator",className:"w-8 h-8 animate-bounce text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s("common.loading")})]}):f?e.jsx("div",{className:"text-center text-destructive py-4",children:s("error.generic")}):l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:s("auction.estimated_total")}),e.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:t(l.total_price)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between py-1 border-b border-dashed",children:[e.jsx("span",{className:"text-muted-foreground",children:s("auction.shipping")}),e.jsx("span",{children:t(l.breakdown.shipping_total)})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b border-dashed",children:[e.jsx("span",{className:"text-muted-foreground",children:s("auction.fees")}),e.jsx("span",{children:t(l.breakdown.service_fee+l.breakdown.broker_fee)})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b border-dashed",children:[e.jsx("span",{className:"text-muted-foreground",children:s("auction.customs")}),e.jsx("span",{children:t(l.breakdown.customs_fee)})]})]})]}):null})]})})})]})};export{K as default};
