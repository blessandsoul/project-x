import{l as xe,j as e,c as ne,I as h,a as we,y as Le,z as Fe,C as Te,D as Me,E as Ue,b as Oe,x as qe,F as Be,r as g,G as He,J as Ve,B as $}from"./index-BmMSjbcy.js";import{C as L,a as G,b as W,c as U}from"./card-0EzdmDD3.js";import{B as Ge}from"./badge-bJ5tqv_c.js";import{f as ve}from"./formatDate-BODqZ6W4.js";import{E as We}from"./EmptyState-B-BhIm8U.js";import{D as Ye,a as Je,b as Xe,c as Ke,d as Qe,e as Ze}from"./dialog-CpM78I3j.js";import{L as de}from"./label-DfwVtDk8.js";import{f as et,a as se,c as tt,u as st,d as at}from"./companiesApi-CNRzlpUl.js";var ae=function(s,x){return s<x?-1:s>x?1:0},je=function(s){return s.reduce(function(x,p){return x+p},0)},nt=(function(){function s(p){this.colors=p}var x=s.prototype;return x.palette=function(){return this.colors},x.map=function(p){return p},s})(),lt=(function(){function s(n,t,o){return(n<<10)+(t<<5)+o}function x(n){var t=[],o=!1;function c(){t.sort(n),o=!0}return{push:function(r){t.push(r),o=!1},peek:function(r){return o||c(),r===void 0&&(r=t.length-1),t[r]},pop:function(){return o||c(),t.pop()},size:function(){return t.length},map:function(r){return t.map(r)},debug:function(){return o||c(),t}}}function p(n,t,o,c,r,l,f){var d=this;d.r1=n,d.r2=t,d.g1=o,d.g2=c,d.b1=r,d.b2=l,d.histo=f}function u(){this.vboxes=new x(function(n,t){return ae(n.vbox.count()*n.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function b(n,t){if(t.count()){var o=t.r2-t.r1+1,c=t.g2-t.g1+1,r=Math.max.apply(null,[o,c,t.b2-t.b1+1]);if(t.count()==1)return[t.copy()];var l,f,d,N,y=0,_=[],E=[];if(r==o)for(l=t.r1;l<=t.r2;l++){for(N=0,f=t.g1;f<=t.g2;f++)for(d=t.b1;d<=t.b2;d++)N+=n[s(l,f,d)]||0;_[l]=y+=N}else if(r==c)for(l=t.g1;l<=t.g2;l++){for(N=0,f=t.r1;f<=t.r2;f++)for(d=t.b1;d<=t.b2;d++)N+=n[s(f,l,d)]||0;_[l]=y+=N}else for(l=t.b1;l<=t.b2;l++){for(N=0,f=t.r1;f<=t.r2;f++)for(d=t.g1;d<=t.g2;d++)N+=n[s(f,d,l)]||0;_[l]=y+=N}return _.forEach(function(I,j){E[j]=y-I}),(function(I){var j,C,v,R,w,S=I+"1",k=I+"2",P=0;for(l=t[S];l<=t[k];l++)if(_[l]>y/2){for(v=t.copy(),R=t.copy(),w=(j=l-t[S])<=(C=t[k]-l)?Math.min(t[k]-1,~~(l+C/2)):Math.max(t[S],~~(l-1-j/2));!_[w];)w++;for(P=E[w];!P&&_[w-1];)P=E[--w];return v[k]=w,R[S]=v[k]+1,[v,R]}})(r==o?"r":r==c?"g":"b")}}return p.prototype={volume:function(n){var t=this;return t._volume&&!n||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(n){var t=this,o=t.histo;if(!t._count_set||n){var c,r,l,f=0;for(c=t.r1;c<=t.r2;c++)for(r=t.g1;r<=t.g2;r++)for(l=t.b1;l<=t.b2;l++)f+=o[s(c,r,l)]||0;t._count=f,t._count_set=!0}return t._count},copy:function(){var n=this;return new p(n.r1,n.r2,n.g1,n.g2,n.b1,n.b2,n.histo)},avg:function(n){var t=this,o=t.histo;if(!t._avg||n){var c,r,l,f,d=0,N=0,y=0,_=0;if(t.r1===t.r2&&t.g1===t.g2&&t.b1===t.b2)t._avg=[t.r1<<3,t.g1<<3,t.b1<<3];else{for(r=t.r1;r<=t.r2;r++)for(l=t.g1;l<=t.g2;l++)for(f=t.b1;f<=t.b2;f++)d+=c=o[s(r,l,f)]||0,N+=c*(r+.5)*8,y+=c*(l+.5)*8,_+=c*(f+.5)*8;t._avg=d?[~~(N/d),~~(y/d),~~(_/d)]:[~~(8*(t.r1+t.r2+1)/2),~~(8*(t.g1+t.g2+1)/2),~~(8*(t.b1+t.b2+1)/2)]}}return t._avg},contains:function(n){var t=this,o=n[0]>>3;return gval=n[1]>>3,bval=n[2]>>3,o>=t.r1&&o<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},u.prototype={push:function(n){this.vboxes.push({vbox:n,color:n.avg()})},palette:function(){return this.vboxes.map(function(n){return n.color})},size:function(){return this.vboxes.size()},map:function(n){for(var t=this.vboxes,o=0;o<t.size();o++)if(t.peek(o).vbox.contains(n))return t.peek(o).color;return this.nearest(n)},nearest:function(n){for(var t,o,c,r=this.vboxes,l=0;l<r.size();l++)((o=Math.sqrt(Math.pow(n[0]-r.peek(l).color[0],2)+Math.pow(n[1]-r.peek(l).color[1],2)+Math.pow(n[2]-r.peek(l).color[2],2)))<t||t===void 0)&&(t=o,c=r.peek(l).color);return c},forcebw:function(){var n=this.vboxes;n.sort(function(r,l){return ae(je(r.color),je(l.color))});var t=n[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(n[0].color=[0,0,0]);var o=n.length-1,c=n[o].color;c[0]>251&&c[1]>251&&c[2]>251&&(n[o].color=[255,255,255])}},{quantize:function(n,t){if(!Number.isInteger(t)||t<1||t>256)throw new Error("Invalid maximum color count. It must be an integer between 1 and 256.");if(!n.length||t<2||t>256||!n.length||t<2||t>256)return!1;for(var o=[],c=new Set,r=0;r<n.length;r++){var l=n[r],f=l.join(",");c.has(f)||(c.add(f),o.push(l))}if(o.length<=t)return new nt(o);var d=(function(j){var C,v=new Array(32768);return j.forEach(function(R){C=s(R[0]>>3,R[1]>>3,R[2]>>3),v[C]=(v[C]||0)+1}),v})(n);d.forEach(function(){});var N=(function(j,C){var v,R,w,S=1e6,k=0,P=1e6,A=0,M=1e6,F=0;return j.forEach(function(T){(v=T[0]>>3)<S?S=v:v>k&&(k=v),(R=T[1]>>3)<P?P=R:R>A&&(A=R),(w=T[2]>>3)<M?M=w:w>F&&(F=w)}),new p(S,k,P,A,M,F,C)})(n,d),y=new x(function(j,C){return ae(j.count(),C.count())});function _(j,C){for(var v,R=j.size(),w=0;w<1e3;){if(R>=C||w++>1e3)return;if((v=j.pop()).count()){var S=b(d,v),k=S[0],P=S[1];if(!k)return;j.push(k),P&&(j.push(P),R++)}else j.push(v),w++}}y.push(N),_(y,.75*t);for(var E=new x(function(j,C){return ae(j.count()*j.volume(),C.count()*C.volume())});y.size();)E.push(y.pop());_(E,t);for(var I=new u;E.size();)I.push(E.pop());return I}}})().quantize,Ne=function(s){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=s.naturalWidth,this.height=this.canvas.height=s.naturalHeight,this.context.drawImage(s,0,0,this.width,this.height)};Ne.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var O=function(){};O.prototype.getColor=function(s,x){return x===void 0&&(x=10),this.getPalette(s,5,x)[0]},O.prototype.getPalette=function(s,x,p){var u=(function(o){var c=o.colorCount,r=o.quality;if(c!==void 0&&Number.isInteger(c)){if(c===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");c=Math.max(c,2),c=Math.min(c,20)}else c=10;return(r===void 0||!Number.isInteger(r)||r<1)&&(r=10),{colorCount:c,quality:r}})({colorCount:x,quality:p}),b=new Ne(s),n=(function(o,c,r){for(var l,f,d,N,y,_=o,E=[],I=0;I<c;I+=r)f=_[0+(l=4*I)],d=_[l+1],N=_[l+2],((y=_[l+3])===void 0||y>=125)&&(f>250&&d>250&&N>250||E.push([f,d,N]));return E})(b.getImageData().data,b.width*b.height,u.quality),t=lt(n,u.colorCount);return t?t.palette():null},O.prototype.getColorFromUrl=function(s,x,p){var u=this,b=document.createElement("img");b.addEventListener("load",function(){var n=u.getPalette(b,5,p);x(n[0],s)}),b.src=s},O.prototype.getImageData=function(s,x){var p=new XMLHttpRequest;p.open("GET",s,!0),p.responseType="arraybuffer",p.onload=function(){if(this.status==200){var u=new Uint8Array(this.response);i=u.length;for(var b=new Array(i),n=0;n<u.length;n++)b[n]=String.fromCharCode(u[n]);var t=b.join(""),o=window.btoa(t);x("data:image/png;base64,"+o)}},p.send()},O.prototype.getColorAsync=function(s,x,p){var u=this;this.getImageData(s,function(b){var n=document.createElement("img");n.addEventListener("load",function(){var t=u.getPalette(n,5,p);x(t[0],this)}),n.src=b})};function it({rating:s,size:x="sm",className:p,showValue:u=!0}){const b=x==="md"?"h-5 w-5":"h-4 w-4",n=x==="md"?"text-lg":"text-sm",t=xe(s);return e.jsxs("div",{className:ne("flex items-center",p),children:[e.jsx(h,{icon:"mdi:star",className:ne(b,"text-warning fill-current")}),u&&e.jsx("span",{className:ne(n,"font-semibold ml-1"),children:t})]})}function rt({className:s,label:x,variant:p="default"}){const u={diamond:"bg-cyan-100 text-cyan-800 ring-1 ring-cyan-400/40",gold:"bg-amber-100 text-amber-800 ring-1 ring-amber-400/40",silver:"bg-slate-100 text-slate-700 ring-1 ring-slate-300/50",default:"bg-amber-500/10 text-amber-700 dark:text-amber-300 ring-1 ring-amber-400/40"},b=x??"VIP",n=p==="diamond"?"mdi:diamond-stone":"mdi:crown";return e.jsxs(Ge,{className:ne("text-xs font-bold uppercase tracking-wide rounded-full px-2 py-0.5 flex items-center gap-1 shadow-sm",u[p]||u.default,s),children:[e.jsx(h,{icon:n,className:"h-3 w-3"}),b]})}function ot({review:s,onEdit:x,onDelete:p,isOwner:u}){const{t:b,i18n:n}=we(),t=Le(s.rating);return e.jsx("div",{className:"py-6 border-b border-slate-100 last:border-0",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"md:w-48 flex-shrink-0",children:e.jsxs("div",{className:"flex items-start gap-4 md:flex-col md:gap-3",children:[e.jsxs(Fe,{className:"h-12 w-12 bg-green-500 text-white font-bold",children:[e.jsx(Te,{src:s.avatar||void 0,alt:s.user_name||"User"}),e.jsx(Me,{className:"bg-green-500 text-white",children:s.user_name?.substring(0,1).toUpperCase()||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-slate-900 text-base leading-tight",children:s.user_name||b("common.user","User")}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-slate-500",children:[e.jsx(h,{icon:"mdi:calendar-month-outline",className:"h-4 w-4 shrink-0"}),e.jsx("span",{children:ve(s.created_at,n.language)})]})]})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 capitalize",children:b(`reviews.labels.${t}`,t.replace("rating_",""))}),e.jsx("div",{className:"flex items-center justify-center h-9 w-11 bg-[#003580] text-white font-bold text-base rounded-[4px] shadow-sm",children:xe(s.rating)})]}),e.jsxs("div",{className:"flex gap-3 text-slate-700",children:[s.rating>=7?e.jsx(h,{icon:"mdi:emoticon-happy-outline",className:"h-6 w-6 text-green-500 shrink-0"}):e.jsx(h,{icon:"mdi:emoticon-sad-outline",className:"h-6 w-6 text-slate-400 shrink-0"}),e.jsx("p",{className:"whitespace-pre-wrap leading-relaxed m-0 text-sm",children:s.comment})]}),s.company_reply&&e.jsxs("div",{className:"mt-4 flex gap-3 text-slate-700",children:[e.jsx("div",{className:"flex flex-col items-center gap-1 shrink-0",children:e.jsx(h,{icon:"mdi:office-building",className:"h-6 w-6 text-slate-400"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-sm text-slate-900",children:b("company_profile.reviews.response_from_company","Response from company")}),s.company_reply_date&&e.jsx("span",{className:"text-xs text-slate-400",children:ve(s.company_reply_date,n.language)})]}),e.jsx("p",{className:"whitespace-pre-wrap leading-relaxed m-0 text-sm",children:s.company_reply})]})]}),u&&e.jsxs("div",{className:"flex justify-end gap-2 mt-4 pt-4",children:[e.jsxs("button",{onClick:()=>x?.(s),className:"text-xs font-medium text-slate-500 hover:text-blue-600 transition-colors flex items-center gap-1",children:[e.jsx(h,{icon:"mdi:pencil",className:"h-3 w-3"}),b("common.edit","Edit")]}),e.jsxs("button",{onClick:()=>s.id&&p?.(String(s.id)),className:"text-xs font-medium text-slate-500 hover:text-red-600 transition-colors flex items-center gap-1",children:[e.jsx(h,{icon:"mdi:delete",className:"h-3 w-3"}),b("common.delete","Delete")]})]})]})]})})}const ct={facebook:{icon:"mdi:facebook",label:"Facebook"},instagram:{icon:"mdi:instagram",label:"Instagram"}},mt=({platform:s,url:x,className:p=""})=>{const u=ct[s];return u?e.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",title:u.label,"aria-label":u.label,className:`p-2.5 rounded-lg bg-slate-100 hover:bg-slate-200 transition-colors ${p}`,children:e.jsx(h,{icon:u.icon,className:"h-5 w-5 text-slate-600"})}):null},vt=()=>{const{t:s,i18n:x}=we(),{id:p}=Ue(),u=Oe(),b=qe(),{addRecentlyViewed:n}=Be(),[t,o]=g.useState(null),[c,r]=g.useState(!0),[l,f]=g.useState(null);g.useEffect(()=>{if(!p){r(!1);return}let a=!1;return r(!0),f(null),et(p).then(m=>{a||(o(m),r(!1))}).catch(m=>{a||(f("Failed to load company"),r(!1))}),()=>{a=!0}},[p]);const d=He.filter(a=>a.companyId===(t?.id??"")),[N,y]=g.useState(!1),[_,E]=g.useState(!1),I=()=>{t?.contact?.phone&&(navigator.clipboard.writeText(t.contact.phone),E(!0),setTimeout(()=>E(!1),2e3))},[j,C]=g.useState([]),[v,R]=g.useState(1),[w,S]=g.useState(1),[k,P]=g.useState(!1),[A,M]=g.useState(null),[F,T]=g.useState(!1),[q,le]=g.useState(10),[Y,ie]=g.useState(""),[J,he]=g.useState(!1),[pe,X]=g.useState(null),[ye,re]=g.useState(null),[oe,K]=g.useState(10),[Q,Z]=g.useState(""),[ee,fe]=g.useState(!1),[_e,ue]=g.useState(!1),ce=g.useRef(null),ge=g.useRef(!0),[B,Ce]=g.useState([]),D=5;g.useEffect(()=>{if(ge.current){ge.current=!1;return}ce.current&&ce.current.scrollIntoView({behavior:"smooth",block:"start"})},[v]);const{user:be,userRole:te}=Ve(),H=t?.logo??"",ke=!!(t?.trustScore&&t.trustScore>=70),V=te==="user"||te==="dealer",Re=g.useMemo(()=>{if(!t)return"";const a=x.language;return a==="ka"&&t.description_geo?t.description_geo:a==="ru"&&t.description_rus?t.description_rus:t.description_eng||t.description_geo||t.description_rus||""},[t,x.language]);g.useEffect(()=>{if(!H)return;const a=new Image;a.crossOrigin="Anonymous",a.src=H,a.onload=()=>{try{const z=new O().getPalette(a,3);if(z&&z.length>0){const De=z.map(me=>`${me[0]}, ${me[1]}, ${me[2]}`);Ce(De)}}catch{}}},[H]),g.useEffect(()=>{b.search&&u(b.pathname,{replace:!0})},[b.search,b.pathname,u]),g.useEffect(()=>{t?.id&&n(String(t.id))},[t?.id]),g.useEffect(()=>{if(!t?.id)return;let a=!1;return(async()=>{P(!0),M(null);try{const z=await se(t.id,{limit:D,offset:(v-1)*D});if(a)return;C(Array.isArray(z.items)?z.items:[]),S(typeof z.totalPages=="number"&&z.totalPages>0?z.totalPages:1)}catch{if(a)return;M(s("company_profile.error.reviews_load"))}finally{a||P(!1)}})(),()=>{a=!0}},[t?.id,D,v,s]);const Se=async a=>{if(a.preventDefault(),!(!t||!V||J||q<1||q>10)){if(Y.trim()&&Y.trim().length<10){X(s("company_profile.error.review_length"));return}he(!0),X(null);try{await tt({company_id:Number(t.id),rating:q,comment:Y.trim()}),le(10),ie(""),T(!1);const m=await se(t.id,{limit:D,offset:(v-1)*D});C(Array.isArray(m.items)?m.items:[]),S(typeof m.totalPages=="number"&&m.totalPages>0?m.totalPages:1)}catch{X(s("company_profile.error.review_submit"))}finally{he(!1)}}},Ee=a=>{re(String(a.id)),K(a.rating),Z(a.comment||"")},Ie=()=>{re(null),K(10),Z("")},Pe=async a=>{if(!(!t||!V||ee)&&!(Q.trim()&&Q.trim().length<10)){fe(!0);try{await st(t.id,a,{rating:oe,comment:Q.trim()||null}),re(null),K(10),Z("");const m=await se(t.id,{limit:D,offset:(v-1)*D});C(Array.isArray(m.items)?m.items:[]),S(typeof m.totalPages=="number"&&m.totalPages>0?m.totalPages:1)}catch{}finally{fe(!1)}}},ze=async a=>{if(!(!t||!V||_e||!confirm(s("company_profile.reviews.delete_confirm")))){ue(!0);try{await at(t.id,a);const m=await se(t.id,{limit:D,offset:(v-1)*D});C(Array.isArray(m.items)?m.items:[]),S(typeof m.totalPages=="number"&&m.totalPages>0?m.totalPages:1)}catch{}finally{ue(!1)}}},$e=a=>!be||!(te==="user"||te==="dealer")?!1:Number(be.id)===a.user_id;if(c)return e.jsx("div",{className:"flex-1 flex items-center justify-center bg-slate-50","aria-busy":"true",children:e.jsx(L,{className:"p-8 border-slate-200 bg-white shadow-sm",children:e.jsx("div",{className:"flex flex-col items-center gap-4",children:e.jsx(h,{icon:"mdi:loading",className:"h-8 w-8 animate-spin text-slate-400"})})})});if(!t)return e.jsx("div",{className:"flex-1 flex items-center justify-center bg-slate-50",children:e.jsx(L,{className:"p-8 border-slate-200 bg-white shadow-sm",children:e.jsx(We,{icon:"mdi:alert-circle",title:s("company_profile.not_found.title"),description:s("company_profile.not_found.description"),action:e.jsx($,{onClick:()=>u("/catalog"),className:"bg-primary hover:bg-primary/90 text-white",children:s("company_profile.not_found.back_to_catalog")})})})});const Ae=B.length>=2?{background:`linear-gradient(135deg, 
          rgba(${B[0]}, 0.15) 0%, 
          rgba(${B[1]}, 0.1) 50%, 
          rgba(${B[2]||B[0]}, 0.05) 100%)`}:{};return e.jsxs("div",{className:"flex-1 flex flex-col relative min-h-screen",children:[e.jsx("div",{className:"fixed inset-0 pointer-events-none z-0 transition-all duration-1000",style:Ae}),e.jsx("section",{className:"relative overflow-hidden z-10",children:e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"w-full px-4 lg:px-8 lg:max-w-[1440px] mx-auto pt-6 pb-8 lg:pt-8 lg:pb-10",children:[e.jsxs($,{variant:"ghost",onClick:()=>u("/catalog"),className:"mb-6 text-slate-700 hover:text-slate-900 hover:bg-white/50",children:[e.jsx(h,{icon:"mdi:arrow-left",className:"me-2 h-4 w-4"}),s("company_profile.back")]}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:items-start lg:gap-8 text-center lg:text-start",children:[H&&e.jsx("div",{className:"relative mb-6 lg:mb-0 flex-shrink-0",children:e.jsx("div",{className:"w-28 h-28 lg:w-32 lg:h-32 mx-auto lg:mx-0 rounded-2xl border-white bg-white shadow-lg",children:e.jsx("img",{src:H,alt:t.name,className:"h-full w-full object-contain rounded-xl"})})}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("div",{className:"flex flex-col lg:flex-row items-center lg:items-start justify-between gap-4 mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-3 mb-3",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 capitalize",children:t.name}),ke&&e.jsx(rt,{})]}),e.jsxs("div",{className:"flex flex-wrap justify-center lg:justify-start gap-2 text-sm mb-4",children:[e.jsxs("div",{className:"flex items-center bg-white/80 border border-slate-200 px-3 py-1.5 rounded-lg shadow-sm",children:[e.jsx(it,{rating:t.rating,size:"sm"}),e.jsxs("span",{className:"ms-1.5 text-slate-600 font-medium",children:["(",t.reviewCount,")"]})]}),e.jsxs("div",{className:"flex items-center bg-white/80 border border-slate-200 px-3 py-1.5 rounded-lg shadow-sm text-slate-700",children:[e.jsx(h,{icon:"mdi:map-marker",className:"h-4 w-4 me-1.5 text-slate-500"}),e.jsxs("span",{className:"capitalize",children:[t.location?.city??"",t.location?.city&&t.location?.state?", ":"",t.location?.state??""]})]}),e.jsxs("div",{className:"flex items-center bg-white/80 border border-slate-200 px-3 py-1.5 rounded-lg shadow-sm text-slate-700",children:[e.jsx(h,{icon:"mdi:calendar",className:"h-4 w-4 me-1.5 text-slate-500"}),e.jsxs("span",{children:[s("company_profile.founded")," ",t.establishedYear]})]})]}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-2xl mx-auto lg:mx-0 leading-relaxed",children:Re})]})}),e.jsxs("div",{className:"flex flex-row flex-wrap justify-center lg:justify-start gap-3 w-full lg:w-auto",children:[e.jsxs(Ye,{open:N,onOpenChange:y,children:[e.jsxs($,{size:"lg",onClick:()=>y(!0),className:"bg-primary hover:bg-primary/90 text-white shadow-lg",children:[e.jsx(h,{icon:"mdi:phone",className:"me-2 h-5 w-5"}),s("company_profile.contact_btn")]}),e.jsxs(Je,{className:"sm:max-w-[400px]",children:[e.jsx("div",{className:"flex justify-center -mt-2 mb-3",children:e.jsx("div",{className:"h-16 w-16 rounded-2xl bg-gradient-to-br from-green-500/10 to-emerald-600/10 flex items-center justify-center shadow-sm",children:e.jsx(h,{icon:"mdi:phone",className:"h-8 w-8 text-green-600"})})}),e.jsxs(Xe,{className:"text-center",children:[e.jsx(Ke,{className:"text-xl",children:s("company_profile.phone.title","Contact Phone")}),e.jsx(Qe,{className:"text-center",children:s("company_profile.phone.description","Call us directly")})]}),e.jsx("div",{className:"py-6",children:t.contact?.phone?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("a",{href:`tel:${t.contact.phone}`,className:"lg:hidden block text-3xl font-bold text-slate-900 hover:text-green-600 transition-colors",children:t.contact.phone}),e.jsx("button",{onClick:I,className:"hidden lg:block w-full text-3xl font-bold text-slate-900 hover:text-green-600 transition-colors",title:s("company_profile.phone.click_to_copy","Click to copy"),children:t.contact.phone}),e.jsx("p",{className:"text-sm text-slate-500 lg:hidden",children:s("company_profile.phone.tap_to_call","Tap to call")}),e.jsx("p",{className:"hidden lg:block text-sm text-slate-500 h-5",children:_?e.jsxs("span",{className:"text-green-600 flex items-center justify-center gap-1 font-medium",children:[e.jsx(h,{icon:"mdi:check-circle",className:"h-4 w-4"}),s("company_profile.phone.copied","Copied!")]}):e.jsx("span",{className:"text-slate-400 group-hover:text-slate-600 transition-colors",children:s("company_profile.phone.click_to_copy","Click to copy")})})]}):e.jsx("p",{className:"text-center text-slate-500",children:s("company_profile.phone.not_available","Phone number not available")})}),e.jsx(Ze,{children:e.jsx($,{variant:"outline",onClick:()=>y(!1),className:"w-full",children:s("common.close","Close")})})]})]}),t.contact?.website&&e.jsxs($,{variant:"outline",size:"lg",className:"bg-white border-slate-300 text-slate-700 hover:bg-slate-50",onClick:()=>{const a=t.contact.website.startsWith("http")?t.contact.website:`https://${t.contact.website}`;window.open(a,"_blank","noopener,noreferrer")},children:[e.jsx(h,{icon:"mdi:web",className:"me-2 h-5 w-5"}),s("company_profile.website_btn")]})]})]})]})]})})}),e.jsx("main",{className:"flex-1 relative z-10 bg-white/60 backdrop-blur-sm",role:"main",children:e.jsx("div",{className:"w-full px-4 lg:px-8 lg:max-w-[1440px] mx-auto py-8",children:e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(L,{className:"border-slate-200 bg-white shadow-sm",children:[e.jsx(G,{children:e.jsx(W,{className:"text-slate-900",children:s("company_profile.services.title")})}),e.jsx(U,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(t.services??[]).map(a=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 border border-slate-100 rounded-lg",children:[e.jsx(h,{icon:"mdi:check-circle",className:"h-5 w-5 text-accent"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:s(`company_profile.services.items.${a.replace(/\s+/g,"_").toLowerCase()}`,a)})]},a))})})]}),d.length>0&&e.jsxs(L,{className:"border-slate-200 bg-white shadow-sm",children:[e.jsx(G,{children:e.jsx(W,{className:"text-slate-900",children:s("company_profile.cars.title")})}),e.jsx(U,{children:e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:d.slice(0,4).map(a=>e.jsxs("div",{className:"flex gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3",children:[a.imageUrl&&e.jsx("img",{src:a.imageUrl,alt:`${a.make} ${a.model}`,className:"h-16 w-24 rounded-md object-cover"}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900",children:[a.year," ",a.make," ",a.model]}),e.jsxs("span",{className:"text-xs font-bold text-slate-900",children:["$",a.price.toLocaleString()]})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[a.bodyType," • ",a.fuelType," • ",a.transmission]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[s("company_profile.cars.mileage"),": ",a.mileage.toLocaleString()," km"]})]})]},a.id))})})]}),e.jsxs(L,{ref:ce,className:"border-slate-200 bg-white shadow-sm",children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"text-slate-900",children:[s("company_profile.reviews.title")," (",t.reviewCount,")"]}),V&&e.jsxs($,{variant:"outline",size:"sm",onClick:()=>T(!F),className:"flex items-center gap-2 border-slate-300 text-slate-700 hover:bg-slate-50",children:[e.jsx(h,{icon:"mdi:plus",className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:s("company_profile.reviews.write")})]})]})}),e.jsxs(U,{className:"space-y-4",children:[V&&F&&e.jsx(L,{className:"border-accent/30 bg-accent/5",children:e.jsx(U,{className:"pt-6",children:e.jsxs("form",{className:"space-y-4",onSubmit:Se,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{htmlFor:"review-comment",className:"text-slate-700",children:s("company_profile.reviews.your_rating")}),e.jsxs("div",{className:"flex items-center space-x-1 rtl:space-x-reverse",children:[[1,2,3,4,5].map(a=>e.jsx("button",{type:"button",className:"focus:outline-none focus:ring-2 focus:ring-accent rounded hover:scale-110 transition-transform",onClick:()=>le(a*2),"aria-label":`${a} stars`,children:e.jsx(h,{icon:"mdi:star",className:`h-5 w-5 ${a*2<=q?"text-accent fill-current":"text-slate-300"}`})},a)),e.jsxs("span",{className:"ms-2 text-sm text-slate-500",children:[q," / 10"]})]})]}),e.jsx("textarea",{id:"review-comment",value:Y,onChange:a=>ie(a.target.value),placeholder:s("company_profile.reviews.comment_placeholder"),className:"min-h-[100px] w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400",required:!0})]}),pe&&e.jsx("p",{className:"text-sm text-red-500",children:pe}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs($,{type:"submit",size:"sm",disabled:J,className:"flex items-center gap-2 bg-primary hover:bg-primary/90 text-white",children:[J&&e.jsx(h,{icon:"mdi:loading",className:"h-4 w-4 animate-spin"}),s("company_profile.reviews.submit")]}),e.jsx($,{type:"button",variant:"outline",size:"sm",onClick:()=>{T(!1),le(10),ie(""),X(null)},disabled:J,className:"border-slate-300 text-slate-600 hover:bg-slate-50",children:s("company_profile.reviews.cancel")})]})]})})}),e.jsxs("div",{className:`space-y-4 ${F?"mt-6":""}`,children:[k&&e.jsx("div",{className:"space-y-3",children:[...Array(3)].map((a,m)=>e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-4 w-24 rounded bg-slate-200"}),e.jsx("div",{className:"h-3 w-16 rounded bg-slate-200"})]}),e.jsx("div",{className:"h-3 w-full rounded bg-slate-200"}),e.jsx("div",{className:"h-3 w-5/6 rounded bg-slate-200"})]},m))}),!k&&A&&e.jsx("p",{className:"text-sm text-red-500",children:A}),!k&&!A&&j.length===0&&e.jsx("p",{className:"text-sm text-slate-500",children:s("company_profile.reviews.empty")}),!k&&!A&&j.length>0&&e.jsx("div",{className:"space-y-4",children:j.map(a=>ye===String(a.id)?e.jsx("div",{className:"py-6 border-b border-slate-100 last:border-b-0 space-y-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[a.avatar&&e.jsx("img",{src:a.avatar,alt:a.user_name||"User",className:"h-9 w-9 rounded-full object-cover border border-slate-200 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-slate-900",children:a.user_name||`${s("common.user")} #${a.user_id}`}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{variant:"ghost",size:"icon",onClick:()=>Pe(String(a.id)),disabled:ee,className:"h-8 w-8 text-green-600 hover:text-green-700 hover:bg-green-50",title:s("common.save"),children:ee?e.jsx(h,{icon:"mdi:loading",className:"h-4 w-4 animate-spin"}):e.jsx(h,{icon:"mdi:check",className:"h-5 w-5"})}),e.jsx($,{variant:"ghost",size:"icon",onClick:Ie,disabled:ee,className:"h-8 w-8 text-slate-400 hover:text-slate-600",title:s("common.cancel"),children:e.jsx(h,{icon:"mdi:close",className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mt-2 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(de,{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:s("company_profile.reviews.your_rating")}),e.jsxs("div",{className:"flex items-center space-x-1 rtl:space-x-reverse",children:[[1,2,3,4,5].map(m=>e.jsx("button",{type:"button",className:"focus:outline-none focus:ring-2 focus:ring-accent rounded transition-transform hover:scale-110",onClick:()=>K(m*2),children:e.jsx(h,{icon:"mdi:star",className:`h-6 w-6 ${m*2<=oe?"text-accent fill-current":"text-slate-300"}`})},m)),e.jsxs("span",{className:"ms-2 text-sm font-bold text-slate-700",children:[oe,"/10"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(de,{htmlFor:`edit-comment-${a.id}`,className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:s("company_profile.reviews.comment_label")}),e.jsx("textarea",{id:`edit-comment-${a.id}`,value:Q,onChange:m=>Z(m.target.value),className:"min-h-[100px] w-full rounded-md border border-slate-200 bg-white px-3 py-2 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-accent/20 focus:border-accent"})]})]})]})]})},`review-edit-${a.id}`):e.jsx(ot,{review:a,onEdit:Ee,onDelete:ze,isOwner:$e(a)},`review-${a.id}-${a.created_at}`))}),w>1&&!A&&e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs($,{variant:"outline",size:"sm",disabled:k||v<=1,onClick:()=>R(a=>Math.max(1,a-1)),className:"border-slate-300 text-slate-600 hover:bg-slate-50",children:[e.jsx(h,{icon:"mdi:chevron-left",className:"h-4 w-4 me-1"}),s("company_profile.reviews.prev")]}),e.jsxs("span",{className:"text-sm text-slate-500",children:[v," / ",w]}),e.jsxs($,{variant:"outline",size:"sm",disabled:k||v>=w,onClick:()=>R(a=>Math.min(w,a+1)),className:"border-slate-300 text-slate-600 hover:bg-slate-50",children:[s("company_profile.reviews.next"),e.jsx(h,{icon:"mdi:chevron-right",className:"h-4 w-4 ms-1"})]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{className:"border-slate-200 bg-white shadow-sm",children:[e.jsx(G,{children:e.jsx(W,{className:"text-slate-900",children:s("company_profile.contact_info.title")})}),e.jsxs(U,{className:"space-y-4",children:[t.contact?.phone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-slate-100",children:e.jsx(h,{icon:"mdi:phone",className:"h-5 w-5 text-slate-600"})}),e.jsx("p",{className:"font-medium text-slate-700",children:t.contact.phone})]}),t.contact?.email&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-slate-100",children:e.jsx(h,{icon:"mdi:email",className:"h-5 w-5 text-slate-600"})}),e.jsx("p",{className:"font-medium text-slate-700",children:t.contact.email})]}),t.contact?.website&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-slate-100",children:e.jsx(h,{icon:"mdi:web",className:"h-5 w-5 text-slate-600"})}),e.jsx("p",{className:"font-medium text-slate-700",children:t.contact.website})]}),(()=>{const a=t.social_links?.filter(m=>m.platform&&(m.platform==="facebook"||m.platform==="instagram")&&(!m.link_type||m.link_type==="social"))||[];return t.social_links&&t.social_links.length>0&&a.length>0?e.jsx("div",{className:"pt-4 border-t border-slate-100 mt-4",children:e.jsx("div",{className:"flex items-center justify-center gap-4",children:a.map((m,z)=>e.jsx(mt,{platform:m.platform,url:m.url},z))})}):null})()]})]}),e.jsxs(L,{className:"border-slate-200 bg-white shadow-sm",children:[e.jsx(G,{children:e.jsx(W,{className:"text-slate-900",children:s("company_profile.stats.title")})}),e.jsx(U,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center p-4 rounded-xl bg-slate-50 border border-slate-100 text-center",children:[e.jsx(h,{icon:"mdi:star",className:"h-6 w-6 text-accent fill-current mb-2"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:xe(t.rating)}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s("company_profile.stats.rating")})]}),e.jsxs("div",{className:"flex flex-col items-center p-4 rounded-xl bg-slate-50 border border-slate-100 text-center",children:[e.jsx(h,{icon:"mdi:chat",className:"h-6 w-6 text-slate-600 mb-2"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:t.reviewCount}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s("company_profile.stats.reviews")})]}),e.jsxs("div",{className:"flex flex-col items-center p-4 rounded-xl bg-slate-50 border border-slate-100 text-center",children:[e.jsx(h,{icon:"mdi:calendar",className:"h-6 w-6 text-slate-600 mb-2"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:t.establishedYear}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s("company_profile.stats.founded")})]}),e.jsxs("div",{className:"flex flex-col items-center p-4 rounded-xl bg-slate-50 border border-slate-100 text-center",children:[e.jsx(h,{icon:"mdi:briefcase",className:"h-6 w-6 text-slate-600 mb-2"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:t.services?.length??0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s("company_profile.stats.services")})]})]})})]})]})]})})})]})};export{vt as default};
