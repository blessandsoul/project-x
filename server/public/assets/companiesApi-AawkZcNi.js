import{af as l,ag as m,aB as S,aj as f,aG as A}from"./index-CpqWAxB1.js";const v={"facebook.com":"mdi:facebook","instagram.com":"mdi:instagram","linkedin.com":"mdi:linkedin","youtube.com":"mdi:youtube","tiktok.com":"mdi:tiktok","x.com":"mdi:twitter","twitter.com":"mdi:twitter"};function a(e){if(typeof e=="number")return e;const t=Number.parseFloat(e);return Number.isNaN(t)?0:t}function F(e){return typeof e!="string"||e.trim().length===0?"/car-logos/toyota.png":e.startsWith("http")?e:`${m}${e}`}function $(e){return Array.isArray(e)?e.filter(t=>typeof t=="string"&&t.trim().length>0).map(t=>t.trim()):[]}function k(e){return Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const r=t;if(typeof r.url!="string"||r.url.trim().length===0)return null;try{const o=new URL(r.url).hostname.replace(/^www\./,""),i=v[o]??"mdi:web",s=r.label?.trim()??o;return{id:String(r.id??r.url),url:r.url,label:s,icon:i}}catch{return null}}).filter(t=>t!==null):[]}function g(e){const t=a(e.base_price),r=a(e.customs_fee),n=a(e.service_fee),o=a(e.broker_fee),i=a(e.insurance??0),s=a(e.price_per_mile),u=t+r+n+o,_=u+s*8e3,y=typeof e.slug=="string"&&e.slug.trim().length>0?e.slug.trim():e.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),b=a(e.rating??0),w=Math.max(0,Math.floor(a(e.reviewCount??0))),h=typeof e.subscription_ends_at=="string"?e.subscription_ends_at:null,p=typeof e.established_year=="number"?e.established_year:new Date(e.created_at).getFullYear();return{id:e.id,slug:y,name:e.name,logo:F(e.logo_url??e.logo??null),description_geo:e.description_geo??"",description_eng:e.description_eng??"",description_rus:e.description_rus??"",services:$(e.services),base_price:t,price_per_mile:s,customs_fee:r,service_fee:n,broker_fee:o,insurance:i,priceRange:{min:u,max:_,currency:"USD"},fees:{base:t,pricePerMile:s,customs:r,service:n,broker:o},final_formula:e.final_formula,rating:b,reviewCount:w,vipStatus:!!e.is_vip,onboarding:{isFree:!!e.subscription_free,endsAt:h},location:{state:e.state??e.country??"",city:e.city??""},contact:{email:e.contact_email??"",phone:e.phone_number??"",website:e.website??""},socialLinks:k(e.social_links),social_links:Array.isArray(e.social_links)?e.social_links.map(c=>({id:typeof c.id=="number"?c.id:0,company_id:typeof c.company_id=="number"?c.company_id:e.id,link_type:c.link_type||"social",platform:c.platform||void 0,url:c.url||"",created_at:typeof c.created_at=="string"?c.created_at:new Date().toISOString(),updated_at:typeof c.updated_at=="string"?c.updated_at:new Date().toISOString()})):void 0,establishedYear:p,reviews:[]}}async function P(e,t){const r=new FormData;r.append("file",t);const n=await A();return(await l.post(`${m}/companies/${e}/logo`,r,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data","X-CSRF-Token":n}})).data}async function T(e,t){return await f("PUT",`/companies/${e}`,t)}async function R(e){await f("DELETE",`/social-links/${e}`,void 0)}async function x(e,t,r,n){const o={link_type:t,url:r};return n&&(o.platform=n),await f("POST",`/companies/${e}/social-links`,o)}async function B(e){try{return(await l.get(`${m}/companies/${e}`)).data}catch(t){throw t}}async function D(e){const t=new URLSearchParams;typeof e.limit=="number"&&t.set("limit",String(e.limit)),typeof e.offset=="number"&&t.set("offset",String(e.offset));const r=e.search?.trim()??"";r.length>=3&&t.set("name",r),typeof e.minRating=="number"&&e.minRating>0&&t.set("min_rating",String(e.minRating)),typeof e.minBasePrice=="number"&&t.set("min_base_price",String(e.minBasePrice)),typeof e.maxBasePrice=="number"&&t.set("max_base_price",String(e.maxBasePrice)),typeof e.maxTotalFee=="number"&&t.set("max_total_fee",String(e.maxTotalFee)),e.country&&t.set("country",e.country),e.city&&t.set("city",e.city),e.isVip&&t.set("is_vip","true"),e.onboardingFree&&t.set("onboarding_free","true"),e.orderBy&&(t.set("order_by",e.orderBy),e.orderDirection&&t.set("order_direction",e.orderDirection));const n=t.toString(),o=n?`${m}/companies/search?${n}`:`${m}/companies/search`;try{const s=(await l.get(o)).data,u=Array.isArray(s.items)?s.items.map(d=>g(d)):[];return{companies:u,total:typeof s.total=="number"?s.total:u.length,limit:typeof s.limit=="number"?s.limit:e.limit??u.length,offset:typeof s.offset=="number"?s.offset:e.offset??0}}catch(i){throw i}}async function E(e){try{const t=await l.get(`${m}/companies/${e}`);return g(t.data)}catch(t){throw t}}async function U(e,t={}){const r=new URLSearchParams;typeof t.limit=="number"&&r.set("limit",String(t.limit)),typeof t.offset=="number"&&r.set("offset",String(t.offset));const n=r.toString(),o=n?`/companies/${e}/reviews?${n}`:`/companies/${e}/reviews`;try{const i=await S(o);return{items:Array.isArray(i.items)?i.items:[],total:typeof i.total=="number"?i.total:0,limit:typeof i.limit=="number"?i.limit:t.limit??10,offset:typeof i.offset=="number"?i.offset:t.offset??0,page:typeof i.page=="number"?i.page:1,totalPages:typeof i.totalPages=="number"?i.totalPages:0}}catch(i){throw i}}async function O(e){const t={rating:e.rating};return e.comment&&e.comment.trim().length>=10&&(t.comment=e.comment.trim()),await f("POST",`/companies/${e.company_id}/reviews`,t)}async function I(e,t,r){const n={};return r.rating!==void 0&&(n.rating=r.rating),r.comment!==void 0&&(n.comment=r.comment),await f("PUT",`/companies/${e}/reviews/${t}`,n)}async function M(e,t){await f("DELETE",`/companies/${e}/reviews/${t}`)}async function N(e){await f("DELETE",`/companies/${e}`,void 0)}export{U as a,B as b,O as c,M as d,R as e,E as f,T as g,x as h,P as i,N as j,D as s,I as u};
