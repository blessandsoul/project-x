import{d as Xe,r as a,a as z,j as e,I as v,c as w,b as be,B as I,O as Ke,u as Ee,x as Pe,S as ie,m as Ve,Q as Se}from"./index-zfRgVEOB.js";import{a as he}from"./formatDate-BODqZ6W4.js";import{c as Ce}from"./confetti.module-C_1cc0iU.js";import{C as Je}from"./checkbox-BRaKOQVN.js";import{D as G,a as X,b as K,c as J,d as Z,e as pe}from"./dialog-DiGkU4yL.js";import{L as le}from"./label-cOKql5fo.js";import{T as Ze}from"./textarea-CL0iUmjH.js";import{c as fe,f as es,a as ss}from"./vehicles-D3vEEtrZ.js";import{u as De}from"./useVehicleWatchlist-FhEReLO9.js";const ts=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],as=Xe("external-link",ts);function Le(s){return s==="c"?"Bike":"Sedan"}function ls(s,r){const[o,n]=a.useState(null),[u,h]=a.useState([]),[x,l]=a.useState([]),[c,m]=a.useState(null),[g,t]=a.useState(!1),[d,f]=a.useState(!1),[C,i]=a.useState(null),[k,b]=a.useState(0),[q,S]=a.useState(!0),[O,H]=a.useState(null),[F,Q]=a.useState(0),[V,j]=a.useState(r?.initialLimit??5),[U,E]=a.useState(0),[P,ve]=a.useState(r?.initialMinRating??null);a.useEffect(()=>{if(!s)return;let y=!0;return(async()=>{t(!0),i(null);try{const N=await es(s);if(!y)return;n(N.vehicle),h(N.photos)}catch(N){if(!y)return;const D=N instanceof Error?N.message:"Failed to load vehicle details";i(D)}finally{y&&t(!1)}})(),()=>{y=!1}},[s,k]);const[je,se]=a.useState(!1);a.useEffect(()=>{if(!s||!o)return;const y=o.source||"",A=o.yard_name||"";if(!y||!A){S(!1),H("Vehicle location data is incomplete. Cannot calculate shipping quotes."),l([]);return}let N=!0;return(async()=>{se(!0);try{const T=Le(o.vehicle_type),L=await fe(s,y,A,"usd",{limit:V,offset:0,...P!==null&&{minRating:P},vehiclecategory:T});if(!N)return;const te=L.price_available!==!1;S(te),H(te?null:L.message||"Price calculation not available"),m(L.distance_miles??null);const ee=Array.isArray(L.quotes)?L.quotes:[];l(ee),E(ee.length),typeof L.total=="number"?Q(L.total):Q(ee.length)}catch{if(!N)return;m(null),l([]),Q(0),S(!1),H("Failed to load shipping quotes. Please try again.")}finally{N&&se(!1)}})(),()=>{N=!1}},[s,o,k,V,P]);const W=a.useCallback(async()=>{if(!s||!o||d||U>=F)return;const y=o.source||"",A=o.yard_name||"";if(!(!y||!A)){f(!0);try{const N=Le(o.vehicle_type),D=await fe(s,y,A,"usd",{limit:V,offset:U,...P!==null&&{minRating:P},vehiclecategory:N}),T=Array.isArray(D.quotes)?D.quotes:[];l(L=>[...L,...T]),E(L=>L+T.length),typeof D.total=="number"&&Q(D.total)}catch{}finally{f(!1)}}},[s,o,d,U,F,V,P]),ne=()=>{E(0),b(y=>y+1)},re=a.useCallback(y=>{j(y)},[]),ce=a.useCallback(y=>{ve(y)},[]),oe=U<F;return{vehicle:o,photos:u,quotes:x,distanceMiles:c,isLoading:g,isLoadingMore:d,isRefreshingQuotes:je,error:C,priceAvailable:q,priceUnavailableMessage:O,recalculate:ne,quotesTotal:F,quotesLimit:V,hasMoreQuotes:oe,loadMoreQuotes:W,setQuotesLimit:re,minRating:P,setMinRating:ce}}const Me=(s,r="USD")=>{if(s==null)return null;const o=typeof s=="number"?s:Number(s);return Number.isFinite(o)?r==="GEL"?`${o.toLocaleString()} GEL`:`$${o.toLocaleString()}`:null};function is({item:s,onViewDetails:r,onToggleWatch:o,isWatched:n=!1,priority:u=!1}){const{t:h}=z(),x=s.primary_photo_url||s.primary_thumb_url||"/cars/1.webp",l=s.last_bid;let c=0;if(l&&l.bid!=null)c=l.bid;else if(s.calc_price!=null){const d=typeof s.calc_price=="number"?s.calc_price:Number(s.calc_price);Number.isFinite(d)&&(c=Math.max(0,d))}let m=null;if(s.buy_it_now_price!=null){const d=typeof s.buy_it_now_price=="number"?s.buy_it_now_price:Number(s.buy_it_now_price);Number.isFinite(d)&&d>0&&(m=d)}else if(s.buy_it_now!=null){const d=typeof s.buy_it_now=="number"?s.buy_it_now:Number(s.buy_it_now);Number.isFinite(d)&&d>0&&(m=d)}const g=m!=null,t=g?Me(m):null;return e.jsx("div",{className:"similar-vehicle-card-wrapper w-full h-full",children:e.jsxs("div",{className:"similar-vehicle-card-inner bg-white border border-slate-200 shadow-md flex flex-col h-full overflow-hidden rounded-lg",children:[e.jsxs("div",{className:"px-3 py-2",children:[e.jsxs("h3",{className:"font-bold text-[14px] leading-snug text-slate-900 uppercase tracking-tight line-clamp-1",children:[s.year," ",s.make," ",s.model]}),e.jsxs("p",{className:"text-[11px] text-slate-600 mt-0.5",children:[h("auction.lot")," ",s.source_lot_id||s.id]})]}),e.jsxs("div",{className:"flex flex-row items-stretch",style:{minHeight:"100px",maxHeight:"120px"},children:[e.jsx("div",{className:"relative w-1/2 flex-shrink-0",children:e.jsx("button",{type:"button",className:"w-full h-full bg-slate-100 focus:outline-none cursor-pointer overflow-hidden",onClick:r,"aria-label":h("auction.view_vehicle_details"),children:e.jsx("img",{src:x,alt:`${s.year} ${s.make} ${s.model}`,className:"w-full h-full object-cover",loading:u?"eager":"lazy"})})}),e.jsxs("div",{className:"w-1/2 flex flex-col justify-start p-2 gap-1 bg-slate-100",children:[e.jsxs("div",{className:"mb-1",children:[e.jsxs("p",{className:"text-[11px] font-bold text-slate-800",children:[h("auction.fields.current_bid"),":"]}),e.jsxs("p",{className:"text-[13px] font-bold text-slate-900",children:[Me(c)," ",e.jsx("span",{className:"text-[10px] font-normal text-slate-500",children:"USD"})]})]}),g&&t&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-[11px] font-bold text-slate-800",children:[h("auction.buy_now_label"),":"]}),e.jsxs("p",{className:"text-[13px] font-bold text-slate-900",children:[t," ",e.jsx("span",{className:"text-[10px] font-normal text-slate-500",children:"USD"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 border-t border-slate-200 mt-auto",children:[e.jsxs("button",{type:"button",className:"flex items-center justify-center gap-1 h-[36px] bg-accent hover:bg-accent/90 text-slate-900 font-semibold text-[11px] transition-colors",onClick:r,children:[e.jsx(v,{icon:"mdi:plus-circle-outline",className:"w-3.5 h-3.5"}),h("common.details")]}),e.jsxs("button",{type:"button",className:w("flex items-center justify-center gap-1 h-[36px] font-semibold text-[11px] transition-colors border-l border-slate-200",n?"bg-green-50 text-green-600":"bg-white hover:bg-slate-50 text-blue-600"),onClick:d=>{d.stopPropagation(),o?.()},children:[e.jsx(v,{icon:n?"mdi:star":"mdi:star-outline",className:"w-3.5 h-3.5"}),h("auction.actions.watch")]}),e.jsx("button",{type:"button",className:"flex items-center justify-center gap-1 h-[36px] bg-[#2563eb] hover:bg-[#1d4ed8] text-white font-semibold text-[11px] transition-colors border-l border-slate-200",onClick:r,children:h("auction.actions.bid_now")})]})]})})}const ns=({year:s,make:r,model:o})=>{const n=be(),{t:u}=z();return e.jsxs("header",{className:"vehicle-header space-y-2 mb-4",children:[e.jsx("div",{className:"vehicle-header-row flex items-center justify-between mb-2",children:e.jsxs(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>n(-1),className:"flex items-center gap-1 px-0 h-auto text-primary text-[13px] font-medium hover:underline",children:[e.jsx(v,{icon:"mdi:arrow-left",className:"w-4 h-4"}),u("vehicle.back_to_results")]})}),e.jsx("div",{className:"vehicle-header-title-row",children:e.jsxs("h1",{className:"vehicle-header-title text-2xl sm:text-3xl font-bold text-primary uppercase",children:[s," ",r," ",o]})})]})},ge="urlchange";function rs(s){return typeof window>"u"?null:new URLSearchParams(window.location.search).get(s)}function cs(s,r,o="replace"){if(typeof window>"u")return;const n=new URL(window.location.href);r===null||r===""?n.searchParams.delete(s):n.searchParams.set(s,r);const u=n.pathname+n.search+n.hash;o==="push"?window.history.pushState({[s]:r},"",u):window.history.replaceState({[s]:r},"",u),window.dispatchEvent(new CustomEvent(ge,{detail:{name:s,value:r}}))}function os(s="page"){const r=a.useCallback(()=>{const x=rs(s);if(x===null)return 1;const l=parseInt(x,10);return isNaN(l)||l<1?1:l},[s]),[o,n]=a.useState(r),u=a.useRef(!1),h=a.useCallback(x=>{const l=Math.max(1,x);n(l),u.current=!0;const c=l<=1?null:String(l);cs(s,c,"replace")},[s]);return a.useEffect(()=>{const x=()=>{const c=r();n(c)},l=c=>{if(u.current){u.current=!1;return}if(c.detail?.name===s){const g=r();n(g)}};return window.addEventListener("popstate",x),window.addEventListener(ge,l),()=>{window.removeEventListener("popstate",x),window.removeEventListener(ge,l)}},[s,r]),[o,h]}function ds({vehicleId:s,auction:r,usacity:o,limit:n=5,vehiclecategory:u}){const[h,x]=os("quotesPage"),l=a.useRef(null),[c,m]=a.useState({quotes:[],total:0,totalPages:1,isLoading:!1,error:null});a.useEffect(()=>{l.current!==null&&l.current!==s&&x(1),l.current=s},[s]),a.useEffect(()=>{if(!s||!r||!o){m({quotes:[],total:0,totalPages:1,isLoading:!1,error:null});return}let d=!0;const f=(h-1)*n;return(async()=>{m(i=>({...i,isLoading:!0,error:null}));try{const i=await fe(s,r,o,"usd",{limit:n,offset:f,...u&&{vehiclecategory:u}});if(!d)return;const k=i.totalPages||1;if(h>k&&k>0){x(k);return}m({quotes:i.quotes||[],total:i.total||0,totalPages:k,isLoading:!1,error:null})}catch(i){if(!d)return;m({quotes:[],total:0,totalPages:1,isLoading:!1,error:i instanceof Error?i.message:"Failed to load quotes"})}})(),()=>{d=!1}},[s,r,o,h,n,u]);const g=a.useCallback(d=>{const f=Math.max(1,d);x(f)},[x]),t=a.useMemo(()=>{if(!c.quotes.length)return{min:0,max:0,avg:0};const d=c.quotes.map(f=>Number(f.total_price)||0).filter(f=>f>0);return d.length?{min:Math.min(...d),max:Math.max(...d),avg:d.reduce((f,C)=>f+C,0)/d.length}:{min:0,max:0,avg:0}},[c.quotes]);return{quotes:c.quotes,total:c.total,totalPages:c.totalPages,currentPage:h,isLoading:c.isLoading,error:c.error,setPage:g,priceStats:t}}const ms=({filteredQuotes:s,priceStats:r,error:o,isLoading:n=!1,priceAvailable:u=!0,priceUnavailableMessage:h,onOpenBreakdown:x,onOpenLeadModal:l,currentPage:c=1,totalPages:m=1,onPageChange:g})=>{const{t,i18n:d}=z(),f=r.min,C=i=>{try{const k=(d.resolvedLanguage||d.language||"en").split("-")[0],b=k==="ge"?"ka":k;return new Intl.NumberFormat(b,{style:"currency",currency:"USD",maximumFractionDigits:0}).format(i)}catch{return`$${i.toLocaleString("en-US",{minimumFractionDigits:0})}`}};return n?e.jsxs("section",{className:"rounded-lg border border-slate-200 bg-white shadow-sm",children:[e.jsx("div",{className:"px-4 py-3 border-b border-slate-100",children:e.jsx("div",{className:"h-4 w-32 rounded bg-slate-100 animate-pulse"})}),e.jsx("div",{className:"p-4 space-y-3",children:[1,2,3].map(i=>e.jsxs("div",{className:"flex items-center gap-3 animate-pulse",children:[e.jsx("div",{className:"size-9 rounded-full bg-slate-100 shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsx("div",{className:"h-3.5 w-28 rounded bg-slate-100"}),e.jsx("div",{className:"h-3 w-20 rounded bg-slate-100"})]}),e.jsx("div",{className:"h-4 w-20 rounded bg-slate-100"})]},i))})]}):o?e.jsxs("section",{className:"rounded-lg border border-slate-200 bg-white shadow-sm p-6 text-center",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o}),e.jsx(I,{variant:"ghost",size:"sm",className:"mt-3 text-xs",children:t("vehicle.quotes_section.try_again","Try again")})]}):u?s.length===0?e.jsx("section",{className:"rounded-lg border border-slate-200 bg-white shadow-sm p-6 text-center",children:e.jsx("p",{className:"text-sm text-slate-600",children:t("vehicle.quotes_section.empty","No offers available yet")})}):e.jsxs("section",{className:"vehicle-quotes-section rounded-lg border border-slate-200 bg-white shadow-sm overflow-hidden","aria-label":t("vehicle.quotes_section.aria_label","Import quotes"),children:[e.jsx("header",{className:"px-4 py-3 border-b border-slate-100 bg-slate-50/30",children:e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsx("div",{className:"min-w-0",children:e.jsx("h2",{className:"text-[13px] font-semibold text-slate-900 uppercase tracking-wide",children:t("vehicle.quotes_section.title","Shipping Quotes")})}),f>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[11px] text-slate-500 uppercase tracking-wide",children:t("vehicle.quotes_section.lowest_price","Lowest Price")}),e.jsx("div",{className:"text-lg font-bold text-emerald-600 tabular-nums",children:C(f)})]})]})}),e.jsx("div",{className:"divide-y divide-slate-100",children:s.map((i,k)=>{const b=Number(i.total_price)||0,q=i.company_rating!=null?i.company_rating.toFixed(1):t("vehicle.quotes_section.rating_na","N/A");return e.jsxs("div",{className:"vehicle-quotes-item px-4 py-3 flex items-center gap-3 min-w-0 transition-colors hover:bg-slate-50/50",children:[e.jsxs("div",{className:"size-9 rounded-full flex items-center justify-center text-xs font-semibold shrink-0 overflow-hidden bg-slate-100 text-slate-700",children:[i.logoUrl?e.jsx("img",{src:i.logoUrl,alt:i.company_name,className:"w-full h-full object-contain",onError:S=>{const O=S.target;O.style.display="none",O.nextSibling&&(O.nextSibling.style.display="flex")}}):null,e.jsx("span",{className:i.logoUrl?"hidden":"",children:i.company_name.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{type:"button",onClick:()=>x(i),className:"font-medium text-slate-900 text-[13px] hover:text-primary transition-colors truncate focus:outline-none focus:underline capitalize",children:i.company_name}),k===0&&c===1&&e.jsx("span",{className:"text-[9px] font-bold text-blue-700 bg-blue-100 px-1.5 py-0.5 rounded uppercase tracking-wide shrink-0",children:t("vehicle.quotes_section.lowest_price","Lowest Price")})]}),e.jsx("div",{className:"flex items-center gap-2 mt-0.5 text-[11px] text-slate-500 flex-wrap",children:e.jsxs("span",{className:"shrink-0",children:["★ ",q]})})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0 flex-wrap justify-end",children:[e.jsx("button",{type:"button",onClick:()=>x(i),className:"text-right focus:outline-none focus:ring-2 focus:ring-primary/20 rounded px-1",children:e.jsx("div",{className:"text-base font-bold tabular-nums whitespace-nowrap text-slate-900",children:C(b)})}),i.website&&e.jsx("a",{href:i.website,target:"_blank",rel:"noopener noreferrer",className:"h-8 w-8 inline-flex items-center justify-center rounded-md border border-slate-300 bg-white text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors focus:outline-none focus:ring-2 focus:ring-primary/20 shrink-0","aria-label":"Open company website",onClick:S=>S.stopPropagation(),children:e.jsx(as,{className:"size-3.5"})})]})]},i.company_id)})}),g&&m>1&&e.jsx("footer",{className:"px-4 py-3 bg-slate-50/50 border-t border-slate-100",children:e.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>g(c-1),disabled:c<=1||n,className:w("h-8 px-3 rounded-md text-[12px] font-medium transition-colors","border border-slate-200",c<=1||n?"bg-slate-50 text-slate-300 cursor-not-allowed":"bg-white text-slate-700 hover:bg-slate-50 hover:text-slate-900"),children:t("vehicle.quotes_section.prev","Prev")}),e.jsx("div",{className:"flex items-center gap-1",children:(()=>{const i=[];if(m<=5)for(let b=1;b<=m;b++)i.push(b);else if(c<=3){for(let b=1;b<=4;b++)i.push(b);i.push("ellipsis"),i.push(m)}else if(c>=m-2){i.push(1),i.push("ellipsis");for(let b=m-3;b<=m;b++)i.push(b)}else i.push(1),i.push("ellipsis"),i.push(c-1),i.push(c),i.push(c+1),i.push("ellipsis"),i.push(m);return i.map((b,q)=>b==="ellipsis"?e.jsx("span",{className:"px-2 text-slate-400",children:"…"},`ellipsis-${q}`):e.jsx("button",{onClick:()=>g(b),disabled:n,className:w("h-8 min-w-[32px] px-2 rounded-md text-[12px] font-medium transition-colors","border",b===c?"bg-primary text-primary-foreground border-primary":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50 hover:text-slate-900",n&&"opacity-50 cursor-not-allowed"),children:b},b))})()}),e.jsx("button",{onClick:()=>g(c+1),disabled:c>=m||n,className:w("h-8 px-3 rounded-md text-[12px] font-medium transition-colors","border border-slate-200",c>=m||n?"bg-slate-50 text-slate-300 cursor-not-allowed":"bg-white text-slate-700 hover:bg-slate-50 hover:text-slate-900"),children:t("vehicle.quotes_section.next","Next")})]})})})]}):e.jsxs("section",{className:"rounded-lg border border-slate-200 bg-white shadow-sm p-6 text-center",children:[e.jsx("div",{className:"text-slate-400 mb-3",children:e.jsx("svg",{className:"w-10 h-10 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),e.jsx("p",{className:"text-sm text-slate-700 font-medium mb-1",children:t("vehicle.quotes_section.unavailable_title","Price calculation unavailable")}),e.jsx("p",{className:"text-xs text-slate-500 max-w-xs mx-auto mb-4",children:h||t("vehicle.quotes_section.unavailable_description","Shipping quotes cannot be calculated for this location.")}),e.jsx(I,{onClick:l,variant:"outline",size:"sm",className:"text-xs",children:t("vehicle.quotes_section.request_custom_quote","Request Custom Quote")})]})},Re=a.memo(({vehicleId:s,auction:r,usacity:o,vehiclecategory:n,priceAvailable:u,priceUnavailableMessage:h,onOpenBreakdown:x,onOpenLeadModal:l})=>{const{quotes:c,total:m,totalPages:g,currentPage:t,isLoading:d,error:f,setPage:C,priceStats:i}=ds({vehicleId:s,auction:r,usacity:o,limit:5,vehiclecategory:n});return e.jsx(ms,{filteredQuotes:c,priceStats:i,error:f,isLoading:d,priceAvailable:u,priceUnavailableMessage:h,onOpenBreakdown:x,onOpenLeadModal:l,total:m,currentPage:t,totalPages:g,onPageChange:C})});Re.displayName="VehicleQuotesContainer";const xs=({isOpen:s,onClose:r,count:o})=>{const{t:n}=z();return a.useEffect(()=>{if(s){const h=Date.now()+3e3,x={startVelocity:30,spread:360,ticks:60,zIndex:100},l=(m,g)=>Math.random()*(g-m)+m,c=setInterval(function(){const m=h-Date.now();if(m<=0)return clearInterval(c);const g=50*(m/3e3);Ce({...x,particleCount:g,origin:{x:l(.1,.3),y:Math.random()-.2}}),Ce({...x,particleCount:g,origin:{x:l(.7,.9),y:Math.random()-.2}})},250);return()=>clearInterval(c)}},[s]),e.jsx(G,{open:s,onOpenChange:r,children:e.jsxs(X,{className:"sm:max-w-[380px]",children:[e.jsx("div",{className:"flex justify-center -mt-2 mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center shadow-lg shadow-emerald-500/30 animate-bounce",children:e.jsx(v,{icon:"mdi:check-bold",className:"h-10 w-10 text-white"})}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-emerald-200 animate-ping opacity-30"})]})}),e.jsxs(K,{children:[e.jsx(J,{className:"text-2xl",children:n("vehicle.success_modal.title")}),e.jsx(Z,{children:n("vehicle.success_modal.description",{count:o})})]}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 my-2",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center shrink-0",children:e.jsx(v,{icon:"mdi:headset",className:"h-4 w-4 text-blue-600"})}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:n("vehicle.success_modal.manager_contact")})]})}),e.jsx(pe,{className:"sm:justify-center pt-2",children:e.jsxs(I,{onClick:r,className:"w-full h-12 rounded-xl font-bold text-base bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 shadow-lg shadow-emerald-500/25",children:[e.jsx(v,{icon:"mdi:check-circle",className:"h-5 w-5 mr-2"}),n("common.great_thanks")]})})]})})},us=({quote:s,isOpen:r,onClose:o})=>{const{t:n}=z();if(!s)return null;const u=l=>l?`$${Number(l).toLocaleString()}`:"—",h=s.breakdown?.transportation_total??s.total_price;s.breakdown?.currency;const x=[{icon:"mdi:truck-delivery",label:n("vehicle.shipping_total"),value:h,color:"text-blue-600",bgColor:"bg-blue-50",isMain:!0},...s.breakdown?.customs_fee!=null?[{icon:"mdi:file-document-check",label:n("vehicle.customs_clearance"),value:s.breakdown.customs_fee,color:"text-purple-600",bgColor:"bg-purple-50"}]:[],...s.breakdown?.broker_fee!=null?[{icon:"mdi:handshake",label:n("vehicle.broker_fees"),value:s.breakdown.broker_fee,color:"text-emerald-600",bgColor:"bg-emerald-50"}]:[],...s.breakdown?.insurance_fee!=null?[{icon:"mdi:shield-check",label:n("vehicle.insurance_optional"),value:s.breakdown.insurance_fee,color:"text-slate-500",bgColor:"bg-slate-50",isOptional:!0}]:[]];return e.jsx(G,{open:r,onOpenChange:o,children:e.jsxs(X,{className:"sm:max-w-[420px]",children:[e.jsx("div",{className:"flex justify-center -mt-2 mb-2",children:e.jsx("div",{className:"h-14 w-14 rounded-2xl bg-gradient-to-br from-blue-500/10 to-primary/10 flex items-center justify-center shadow-sm",children:e.jsx(v,{icon:"mdi:calculator-variant",className:"h-7 w-7 text-primary"})})}),e.jsxs(K,{children:[e.jsx(J,{children:n("vehicle.price_breakdown")}),e.jsxs(Z,{children:[n("vehicle.detailed_quote")," ",e.jsx("span",{className:"font-semibold text-slate-700",children:s.company_name})]})]}),e.jsx("div",{className:"space-y-3 my-2",children:x.map((l,c)=>e.jsxs("div",{className:w("flex items-center justify-between p-3 rounded-xl transition-all",l.isOptional?"bg-slate-50/50":"bg-slate-50 hover:bg-slate-100/80"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:w("h-9 w-9 rounded-lg flex items-center justify-center",l.bgColor),children:e.jsx(v,{icon:l.icon,className:w("h-4.5 w-4.5",l.color)})}),e.jsxs("span",{className:w("text-sm font-medium",l.isOptional?"text-slate-400":"text-slate-700"),children:[l.label,l.isOptional&&e.jsx("span",{className:"text-[10px] ml-1 text-slate-400",children:"(opt)"})]})]}),e.jsx("span",{className:w("font-bold tabular-nums",l.isOptional?"text-slate-400 text-sm":"text-slate-900"),children:u(l.value)})]},c))}),e.jsx("div",{className:"bg-gradient-to-r from-primary/10 via-primary/5 to-emerald-500/10 p-4 rounded-xl border border-primary/10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"mdi:sigma",className:"h-5 w-5 text-primary"}),e.jsx("span",{className:"font-bold text-primary uppercase text-xs tracking-wider",children:n("vehicle.total_estimated")})]}),e.jsx("span",{className:"font-black text-2xl text-slate-900",children:u(s.total_price)})]})}),e.jsxs("p",{className:"text-[11px] text-slate-400 text-center flex items-center justify-center gap-1.5 mt-2",children:[e.jsx(v,{icon:"mdi:information-outline",className:"h-3.5 w-3.5"}),n("vehicle.price_note")]})]})})},hs=({photos:s})=>{const[r,o]=a.useState(0),[n,u]=a.useState(!1);if(!s.length)return e.jsx("div",{className:"aspect-[4/3] w-full bg-slate-200 flex items-center justify-center text-slate-400",children:"No Photos"});const h=()=>o(l=>l>0?l-1:s.length-1),x=()=>o(l=>l<s.length-1?l+1:0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative bg-card rounded-2xl overflow-hidden border border-border/70 shadow-sm",children:[e.jsx("img",{src:s[r]?.url,alt:"Vehicle",className:"w-full aspect-[4/3] object-cover cursor-pointer",onClick:()=>u(!0)}),e.jsx("button",{onClick:h,className:"absolute left-3 top-1/2 -translate-y-1/2 w-9 h-9 bg-background/90 rounded-full flex items-center justify-center hover:bg-background shadow-sm border border-border/60",children:e.jsx(v,{icon:"mdi:chevron-left",className:"w-5 h-5 text-foreground/80"})}),e.jsx("button",{onClick:x,className:"absolute right-3 top-1/2 -translate-y-1/2 w-9 h-9 bg-background/90 rounded-full flex items-center justify-center hover:bg-background shadow-sm border border-border/60",children:e.jsx(v,{icon:"mdi:chevron-right",className:"w-5 h-5 text-foreground/80"})}),e.jsxs("div",{className:"absolute bottom-3 right-3 bg-background text-foreground text-[11px] px-2 py-1 rounded-full flex items-center gap-1.5 border border-border/60 shadow-sm",children:[e.jsx(v,{icon:"mdi:camera",className:"w-3.5 h-3.5 text-muted-foreground"}),e.jsxs("span",{className:"tabular-nums",children:[r+1,"/",s.length]})]})]}),e.jsx("div",{className:"copart-gallery-thumbs grid grid-cols-3 sm:grid-cols-5 md:grid-cols-7 gap-1.5 min-w-0",children:s.slice(0,14).map((l,c)=>e.jsx("button",{onClick:()=>o(c),className:w("relative aspect-[4/3] overflow-hidden rounded-lg border transition-all bg-muted",r===c?"border-primary ring-1 ring-primary/70":"border-transparent opacity-80 hover:opacity-100"),children:e.jsx("img",{src:l.url,alt:"",className:"h-full w-full object-cover"})},c))})]}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",children:[e.jsx("button",{onClick:()=>u(!1),className:"absolute top-4 right-4 z-50 w-10 h-10 bg-white/90 hover:bg-white rounded-full flex items-center justify-center shadow-lg transition-colors","aria-label":"Close",children:e.jsx(v,{icon:"mdi:close",className:"w-5 h-5 text-gray-900"})}),e.jsx("img",{src:s[r]?.url,alt:"Vehicle",className:"max-w-full max-h-full object-contain"}),e.jsx("button",{onClick:h,className:"absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-white/90 hover:bg-white rounded-full flex items-center justify-center shadow-lg transition-colors","aria-label":"Previous image",children:e.jsx(v,{icon:"mdi:chevron-left",className:"w-6 h-6 text-gray-900"})}),e.jsx("button",{onClick:x,className:"absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-white/90 hover:bg-white rounded-full flex items-center justify-center shadow-lg transition-colors","aria-label":"Next image",children:e.jsx(v,{icon:"mdi:chevron-right",className:"w-6 h-6 text-gray-900"})}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-white/90 text-gray-900 text-sm px-4 py-2 rounded-full flex items-center gap-2 shadow-lg",children:[e.jsx(v,{icon:"mdi:camera",className:"w-4 h-4"}),e.jsxs("span",{className:"tabular-nums font-medium",children:[r+1," / ",s.length]})]})]})]})},ps=({baseVehicleId:s})=>{const{t:r}=z(),o=be(),{isAuthenticated:n}=Pe(),{isWatched:u,toggleWatch:h}=De(),[x,l]=a.useState([]),[c,m]=a.useState(!1),[g,t]=a.useState(null),d=Ee(),f=a.useRef(null),[C,i]=a.useState(!1),[k,b]=a.useState(0),[q,S]=a.useState(0);a.useEffect(()=>{let j=!0;return(async()=>{m(!0),t(null);try{const E=await ss(s,{limit:20});if(!j)return;const P=Array.isArray(E.items)?E.items:[];l(P.slice(0,10))}catch(E){if(!j)return;const P=E instanceof Error?E.message:"Failed to load similar vehicles";t(P)}finally{j&&m(!1)}})(),()=>{j=!1}},[s]);const O=a.useCallback(j=>{if(!n){o("/login");return}h(j)},[n,o,h]),H=j=>{f.current&&(i(!0),b(j.pageX-f.current.offsetLeft),S(f.current.scrollLeft))},F=()=>{i(!1)},Q=()=>{i(!1)},V=j=>{if(!C||!f.current)return;j.preventDefault();const E=(j.pageX-f.current.offsetLeft-k)*2;f.current.scrollLeft=q-E};return a.useEffect(()=>{const j=()=>{i(!1)};if(C)return window.addEventListener("mouseup",j),()=>window.removeEventListener("mouseup",j)},[C]),c?e.jsxs("section",{className:"space-y-4 pt-8 border-t",children:[e.jsx("h2",{className:"text-xl font-bold",children:r("vehicle.similar.title")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ie,{className:"h-64 rounded-xl"}),e.jsx(ie,{className:"h-64 rounded-xl hidden sm:block"}),e.jsx(ie,{className:"h-64 rounded-xl hidden sm:block"})]})]}):g||!x.length?null:e.jsxs(Ve.section,{className:"similar-vehicles-section space-y-4 pt-8 border-t overflow-hidden",initial:d?!1:{opacity:0,y:16},whileInView:d?{}:{opacity:1,y:0},viewport:{once:!0,amount:.2},transition:{duration:.25,ease:"easeOut"},children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xl font-bold",children:r("vehicle.similar.title")})}),e.jsx("div",{ref:f,className:w("flex overflow-x-auto gap-4 pb-4 -mx-4 px-4 scrollbar-hide select-none",C?"snap-none cursor-grabbing":"snap-x snap-mandatory cursor-grab"),onMouseDown:H,onMouseLeave:F,onMouseUp:Q,onMouseMove:V,children:x.map(j=>e.jsx("div",{className:"flex-shrink-0 w-[240px] min-[460px]:w-[280px] min-[500px]:w-[340px] sm:w-[380px] md:w-[420px] lg:w-[400px] snap-start",children:e.jsx(is,{item:j,priority:!1,onViewDetails:()=>o({pathname:`/vehicle/${j.id}`}),onToggleWatch:()=>O(j.id),isWatched:u(j.id)})},j.id))})]})},Ss=()=>{const{t:s,i18n:r}=z(),{id:o}=Ke(),n=be(),u=Ee(),{isAuthenticated:h,userRole:x}=Pe(),{isWatched:l,toggleWatch:c,isLoading:m}=De(),g=a.useRef(null);if(g.current===null){const p=new URLSearchParams(window.location.search),_=p.get("limit"),M=p.get("rating"),R=_?parseInt(_,10):5,$=M?parseFloat(M):null;g.current={limit:[5,10,15].includes(R)?R:5,rating:$&&$>0?$:null}}const{vehicle:t,photos:d,quotes:f,isLoading:C,priceAvailable:i,priceUnavailableMessage:k}=ls(o?Number(o):null,{initialLimit:g.current.limit,initialMinRating:g.current.rating}),[b,q]=a.useState(!1),[S,O]=a.useState([]),[H,F]=a.useState(!1),[Q,V]=a.useState(!1),[j,U]=a.useState(null),[E,P]=a.useState(!1),[ve,je]=a.useState(!1),[se,W]=a.useState(!1),[ne,re]=a.useState(!1),[ce,oe]=a.useState(""),[y,A]=a.useState(""),[N,D]=a.useState("whatsapp"),[T,L]=a.useState(!1),[te,ee]=a.useState(""),[de,Oe]=a.useState(!1),[we,Ne]=a.useState(!0),[Ue,ye]=a.useState(!1),[_e,Ie]=a.useState(!1),[qe,me]=a.useState(!1),Y=a.useMemo(()=>[...t?.bids||[]].sort((_,M)=>{const R=_?.bid_time?new Date(_.bid_time).getTime():0,$=M?.bid_time?new Date(M.bid_time).getTime():0;return!R&&!$?0:R?$?$-R:-1:1}),[t]),ae=Y[0]||null,Fe=ae?.bid??0,ke=a.useMemo(()=>ae?.bid_time?he(ae.bid_time,r.language):null,[r.language,ae?.bid_time]);a.useEffect(()=>{const p=t?.engine_view;if(!p||_e)return;const _=setTimeout(()=>{const M=document.createElement("video");M.preload="auto",M.src=p,M.load(),Ie(!0)},2e3);return()=>clearTimeout(_)},[t,_e]),a.useEffect(()=>{let p=window.scrollY||0;const _=()=>{const M=window.scrollY||0,R=M-p;Math.abs(R)<10||(M>100&&R>0?Ne(!1):R<0&&Ne(!0),p=M)};return window.addEventListener("scroll",_,{passive:!0}),()=>window.removeEventListener("scroll",_)},[]);const B=a.useMemo(()=>f.length?[...f].sort((p,_)=>(Number(p.total_price)||0)-(Number(_.total_price)||0))[0]:null,[f]),Qe=a.useCallback(p=>{U(p)},[]),Ae=a.useCallback(()=>{W(!0)},[]),Te=p=>{p.preventDefault(),de&&(F(!0),V(!1),alert("Feature Unlocked! You can now select up to 5 companies."))},Be=async p=>{if(p.preventDefault(),!(S.length===0||!o)){L(!0);try{alert("This feature has been removed. Please contact companies directly."),W(!1),b||O([])}catch{alert("Failed to send request. Please try again.")}finally{L(!1)}}},xe=Number(t?.buy_it_now_price||t?.final_bid||0),$e=B?Number(B.breakdown?.shipping_total)||1200:0,ze=B?Number(B.breakdown?.customs_fee)||500:0,He=B&&Number(B.breakdown?.broker_fee)||300,We=B?Number(B.total_price):xe+$e+ze+He,[ue,fs]=a.useState(null),Ye=Number.isFinite(ue)&&ue>=0?ue:xe,Ge=Math.max(0,We+(Ye-xe));return C?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(ie,{className:"h-96 w-full max-w-4xl"})}):t?e.jsxs("div",{className:"flex-1 flex flex-col bg-slate-50",children:[e.jsxs("div",{className:"vehicle-details-container w-full px-4 lg:px-8 lg:max-w-[1440px] mx-auto py-8 lg:py-10",children:[e.jsx(ns,{year:t.year,make:t.make,model:t.model}),e.jsxs(Ve.div,{className:"vehicle-main-grid grid md:grid-cols-2 lg:grid-cols-12 gap-5 xl:gap-6 items-start min-h-[60vh] lg:min_h-[70vh] pb-6 min-w-0",initial:u?!1:{opacity:0,y:8},animate:u?{}:{opacity:1,y:0},transition:{duration:.22,ease:"easeOut"},children:[e.jsxs("div",{className:"md:col-span-1 lg:col-span-4 space-y-4 w-full min-w-0",children:[e.jsx(hs,{photos:d}),(t.iaai_360_view||t.copart_360_interior_view)&&e.jsxs("div",{className:"flex gap-2",children:[t.iaai_360_view&&e.jsxs("a",{href:t.iaai_360_view,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors shadow-sm",children:[e.jsx(v,{icon:"mdi:rotate-3d-variant",className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-[12px] font-medium text-slate-700",children:"360° Exterior"})]}),t.copart_360_interior_view&&e.jsxs("a",{href:t.copart_360_interior_view,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors shadow-sm",children:[e.jsx(v,{icon:"mdi:car-seat",className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-[12px] font-medium text-slate-700",children:"360° Interior"})]})]})]}),e.jsx("div",{className:"md:col-span-1 lg:col-span-4 space-y-5 w-full min-w-0",children:e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-2 border-b border-slate-100",children:e.jsx("h2",{className:"text-[13px] font-semibold text-slate-900",children:s("vehicle.details.title","Vehicle details")})}),e.jsxs("div",{className:"divide-y divide-slate-100",children:[t.source_lot_id&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.lot_number","Lot number:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase break-all",children:t.source_lot_id})]}),t.vin&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.vin","VIN:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase break-all",children:t.vin})]}),t.document&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.title_code","Title code:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase break-words",children:t.document})]}),e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.odometer","Odometer:")}),e.jsxs("span",{className:"text-[11px] font-medium text-slate-900 uppercase truncate",children:[(t.mileage||0).toLocaleString()," MI"]})]}),t.damage_main_damages&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.primary_damage","Primary damage:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase break-words",children:t.damage_main_damages})]}),t.retail_value&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.estimated_retail_value","Estimated retail value:")}),e.jsxs("span",{className:"text-[11px] font-medium text-slate-900",children:["$",Number(t.retail_value).toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.cylinders","Cylinders:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase",children:t.cylinders||0})]}),t.color&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.color","Color:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase break-words",children:t.color})]}),(t.engine_volume||t.cylinders)&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.engine_type","Engine type:")}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase truncate",children:t.engine_volume&&t.cylinders?`${t.engine_volume}L ${t.cylinders}`:t.engine_volume?`${t.engine_volume}L`:t.cylinders}),t.engine_view&&e.jsx("button",{onClick:()=>ye(!0),className:"text-[11px] text-primary hover:underline shrink-0",children:s("vehicle.details.view_engine","View engine")})]})]}),t.transmission&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.transmission","Transmission:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase break-words",children:s(`auction.filters.${t.transmission.toLowerCase().trim()}`,t.transmission)})]}),t.drive&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.drive","Drive:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase",children:t.drive})]}),e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.vehicle_type","Vehicle type:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase",children:s("vehicle.details.vehicle_type_value","HARDCODED")})]}),t.engine_fuel&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.fuel","Fuel:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase",children:s(`auction.filters.${t.engine_fuel.toLowerCase().trim()}`,t.engine_fuel)})]}),e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.keys","Keys:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 uppercase",children:t.has_keys?s("vehicle.details.yes","YES"):s("vehicle.details.no","NO")})]}),t.run_and_drive&&e.jsxs("div",{className:"grid grid-cols-[120px_1fr] md:grid-cols-[130px_1fr] px-4 py-1.5 min-w-0",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.details.highlights","Highlights:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-900 truncate",children:s("vehicle.details.run_and_drive","Run and Drive")})]})]})]})}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-4 space-y-4 w-full min-w-0",children:[e.jsx("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[t?.yard_name&&e.jsx("span",{className:"text-[12px] font-semibold text-primary uppercase pb-[5px]",children:t.yard_name}),e.jsxs(I,{variant:"default",size:"sm",disabled:m,onClick:()=>{if(!h){n("/login");return}c(t.id)},className:w("flex items-center gap-2 text-[12px] font-semibold border shadow-sm min-w-[100px] justify-center transition-all",l(t.id)?"bg-green-600 hover:bg-green-700 text-white border-green-600":"bg-white hover:bg-slate-50 text-slate-700 border-slate-300"),children:[e.jsx(v,{icon:l(t.id)?"mdi:heart":"mdi:heart-outline",className:w("w-4 h-4 transition-transform",l(t.id)&&"scale-110")}),e.jsx("span",{className:"truncate",children:l(t.id)?s("vehicle.watchlist.saved","Saved"):s("vehicle.watchlist.save","Save")})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.bids.last_bid","Last bid:")}),e.jsxs("span",{className:"text-[13px] font-semibold text-slate-900",children:["$",Fe.toLocaleString()]})]}),ke&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[11px] text-slate-500",children:s("vehicle.bids.last_bid_date","Last bid date:")}),e.jsx("span",{className:"text-[11px] font-medium text-slate-700",children:ke})]}),Y.length>0&&e.jsx("button",{onClick:()=>me(!0),className:"text-[11px] text-primary hover:underline mt-1",children:s("vehicle.bids.view_all","View all bids ({{count}})",{count:Y.length})})]})]})}),e.jsx(Re,{vehicleId:t?.id||0,auction:t?.source||"",usacity:t?.yard_name||"",vehiclecategory:t?.vehicle_type==="c"?"Bike":"Sedan",priceAvailable:i,priceUnavailableMessage:k,onOpenBreakdown:Qe,onOpenLeadModal:Ae})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(ps,{baseVehicleId:t.id})})]}),e.jsx(xs,{isOpen:ne,onClose:()=>re(!1),count:S.length||1}),t.engine_view&&e.jsx(G,{open:Ue,onOpenChange:ye,children:e.jsxs(X,{className:"max-w-3xl p-0 overflow-hidden",children:[e.jsxs(K,{className:"p-4 pb-0",children:[e.jsx(J,{children:"Engine View"}),e.jsxs(Z,{children:[t.year," ",t.make," ",t.model]})]}),e.jsx("div",{className:"p-4",children:e.jsx("video",{src:t.engine_view,controls:!0,autoPlay:!0,preload:"auto",playsInline:!0,className:"w-full rounded-lg bg-black",children:"Your browser does not support the video tag."})})]})}),e.jsx(G,{open:qe,onOpenChange:me,children:e.jsxs(X,{className:"max-w-lg",children:[e.jsxs(K,{children:[e.jsx(J,{children:s("vehicle.bid_history.title","Bid History")}),e.jsxs(Z,{children:[t.year," ",t.make," ",t.model," • ",s("vehicle.bid_history.bids_count","{{count}} bid",{count:Y.length})]})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:Y.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500 text-sm",children:s("vehicle.bid_history.no_bids","No bids recorded for this vehicle")}):e.jsx("div",{className:"divide-y divide-slate-100",children:Y.map((p,_)=>e.jsxs("div",{className:"flex items-center justify-between py-3 px-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:w("w-8 h-8 rounded-full flex items-center justify-center text-[11px] font-bold",_===0?"bg-green-100 text-green-700":"bg-slate-100 text-slate-600"),children:`#${_+1}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-[13px] font-semibold text-slate-900",children:["$",(p.bid??0).toLocaleString()]}),_===0&&e.jsx("span",{className:"text-[10px] text-green-600 font-medium uppercase",children:s("vehicle.bid_history.latest_bid","Latest Bid")})]})]}),e.jsx("div",{className:"text-right",children:p.bid_time?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-[11px] text-slate-700",children:he(p.bid_time,r.language,{month:"short",day:"numeric",year:"numeric"})}),e.jsx("div",{className:"text-[10px] text-slate-500",children:he(p.bid_time,r.language,{hour:"2-digit",minute:"2-digit"})})]}):e.jsx("span",{className:"text-[11px] text-slate-400",children:s("vehicle.bid_history.no_date","No date")})})]},_))})}),e.jsx(pe,{children:e.jsx(I,{variant:"outline",onClick:()=>me(!1),children:s("common.close","Close")})})]})}),e.jsxs("div",{className:w("fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-lg border-t p-4 md:hidden z-50 flex items-center justify-between shadow-[0_-4px_10px_rgba(0,0,0,0.05)] safe-area-bottom transition-transform duration-300",we?"translate-y-0":"translate-y-full",!we&&"hidden"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-muted-foreground uppercase font-bold tracking-wider",children:s("vehicle.mobile_cta.total_est")}),e.jsxs("p",{className:"text-xl font-extrabold text-primary leading-none",children:["$",Ge.toLocaleString()]})]}),e.jsx(I,{onClick:()=>{S.length>0?W(!0):document.getElementById("quotes-table")?.scrollIntoView({behavior:"smooth"})},size:"lg",className:"shadow-lg font-bold px-6",children:S.length>0?s("vehicle.mobile_cta.request",{count:S.length}):s("vehicle.mobile_cta.select")})]}),e.jsx(G,{open:se,onOpenChange:W,children:e.jsxs(X,{className:"sm:max-w-[420px]",children:[e.jsx("div",{className:"flex justify-center -mt-2 mb-2",children:e.jsx("div",{className:"h-14 w-14 rounded-2xl bg-gradient-to-br from-primary/10 to-emerald-500/10 flex items-center justify-center shadow-sm",children:e.jsx(v,{icon:"mdi:car-connected",className:"h-7 w-7 text-primary"})})}),e.jsxs(K,{children:[e.jsx(J,{className:"text-center",children:s("vehicle.lead_modal.title")}),e.jsx(Z,{className:"text-center",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:s("vehicle.lead_modal.description",{count:S.length})}})})]}),e.jsxs("form",{onSubmit:Be,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"name",className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:s("vehicle.lead_modal.your_name")}),e.jsx(Se,{id:"name",placeholder:"John Doe",value:ce,onChange:p=>oe(p.target.value),required:!0,className:"h-12 rounded-xl border-slate-200 bg-slate-50/50 px-4 text-base placeholder:text-slate-400 focus:bg-white focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"phone",className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:s("vehicle.lead_modal.phone")}),e.jsx(Se,{id:"phone",placeholder:"+995 555 00 00 00",value:y,onChange:p=>A(p.target.value),required:!0,className:"h-12 rounded-xl border-slate-200 bg-slate-50/50 px-4 text-base placeholder:text-slate-400 focus:bg-white focus:border-primary focus:ring-2 focus:ring-primary/10 transition-all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:s("vehicle.lead_modal.contact_method")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>D("whatsapp"),className:w("flex flex-col items-center gap-2 p-4 rounded-xl border-2 transition-all duration-200",N==="whatsapp"?"border-green-500 bg-green-50 shadow-sm shadow-green-500/20":"border-slate-200 bg-white hover:border-slate-300 hover:bg-slate-50"),children:[e.jsx("div",{className:w("h-10 w-10 rounded-full flex items-center justify-center transition-all",N==="whatsapp"?"bg-green-500 text-white":"bg-slate-100 text-slate-500"),children:e.jsx(v,{icon:"mdi:whatsapp",className:"h-5 w-5"})}),e.jsx("span",{className:w("text-sm font-semibold transition-colors",N==="whatsapp"?"text-green-700":"text-slate-600"),children:s("vehicle.lead_modal.whatsapp")})]}),e.jsxs("button",{type:"button",onClick:()=>D("phone"),className:w("flex flex-col items-center gap-2 p-4 rounded-xl border-2 transition-all duration-200",N==="phone"?"border-blue-500 bg-blue-50 shadow-sm shadow-blue-500/20":"border-slate-200 bg-white hover:border-slate-300 hover:bg-slate-50"),children:[e.jsx("div",{className:w("h-10 w-10 rounded-full flex items-center justify-center transition-all",N==="phone"?"bg-blue-500 text-white":"bg-slate-100 text-slate-500"),children:e.jsx(v,{icon:"mdi:phone",className:"h-5 w-5"})}),e.jsx("span",{className:w("text-sm font-semibold transition-colors",N==="phone"?"text-blue-700":"text-slate-600"),children:s("vehicle.lead_modal.phone_call")})]})]})]}),e.jsx(I,{type:"submit",className:"w-full h-12 rounded-xl font-bold text-base shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/30 transition-all",disabled:T,children:T?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"mdi:loading",className:"h-5 w-5 animate-spin"}),s("vehicle.lead_modal.sending")]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"mdi:send",className:"h-5 w-5"}),s("vehicle.lead_modal.send_request",{count:S.length})]})}),e.jsxs("p",{className:"text-center text-[11px] text-slate-400 flex items-center justify-center gap-1.5",children:[e.jsx(v,{icon:"mdi:shield-check",className:"h-3.5 w-3.5 text-emerald-500"}),s("vehicle.lead_modal.secure_note",{defaultValue:"Your data is secure and will only be shared with selected companies"})]})]})]})}),e.jsx(us,{quote:j,isOpen:!!j,onClose:()=>U(null)}),e.jsx(G,{open:Q,onOpenChange:V,children:e.jsxs(X,{children:[e.jsxs(K,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(v,{icon:"mdi:lock-open-variant",className:"text-primary"}),s("vehicle.unlock_modal.title")]}),e.jsx(Z,{children:s("vehicle.unlock_modal.description")})]}),e.jsxs("form",{onSubmit:Te,className:"space-y-4 py-2",children:[e.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:s("vehicle.unlock_modal.like_project")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{id:"like",checked:de,onCheckedChange:p=>Oe(p===!0)}),e.jsx(le,{htmlFor:"like",className:"text-xs",children:s("vehicle.unlock_modal.i_liked")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s("vehicle.unlock_modal.write_review")}),e.jsx(Ze,{placeholder:s("vehicle.unlock_modal.review_placeholder"),value:te,onChange:p=>ee(p.target.value),className:"h-20 text-xs"})]})]}),e.jsx(pe,{children:e.jsx(I,{type:"submit",disabled:!de,className:"w-full",children:s("vehicle.unlock_modal.unlock_btn")})})]})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"container p-8 text-center",children:s("vehicle.not_found")})})};export{Ss as default};
